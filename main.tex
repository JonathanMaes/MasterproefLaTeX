\documentclass[11pt,a4paper,english]{article}

%%%% PACKAGES WITH OPTIONS
\usepackage[english]{babel}
\usepackage[T1]{fontenc}
\usepackage[margin=2.5cm]{geometry}
\usepackage{lmodern}
\usepackage[utf8]{inputenc}
\usepackage[version=4]{mhchem} % Chemistry and isotopes with \ce{} (other option: 'chemformula' \ch{})
\usepackage[numbers]{natbib} % numbers: needed argument, otherwise error
\usepackage[section]{placeins} % Place floats in their own section
\usepackage[onehalfspacing]{setspace} % Space vertically between lines
\usepackage[raggedright,noindentafter]{titlesec} % Change section/title layout
\usepackage[nottoc,notlot,notlof]{tocbibind} % Include bibliography in table of contents

%%%% PACKAGES WITHOUT OPTIONS
\usepackage{adjustbox} % Use \begin{adjustbox}{center} environment for too wide floats
\usepackage{amsmath, amsfonts, amssymb}
\usepackage{booktabs} % Lines in tables (\<top,mid,bottom>rule)
\usepackage{ctable} % Usage: \ctable[options]{column def like c|c|r|l}{\tnote commands for footnotes}{normal table content}, with \tnote[symbol]{text} footnote definitions, and \tmark[symbol] used to reference the footnote in the normal table content
\usepackage{enumitem} % Lists
\usepackage{flafter} % Place floats after their first appearance in text
\usepackage{float} % [H] modifier for floats etc.
\usepackage{graphicx}
\usepackage{hyperref, cleveref} % Creates links (boxes in various colors around words)
%\usepackage{indentfirst} % Always indent the first line of a section
\usepackage{listings} % Typesetting source code
\usepackage{longtable}
\usepackage{pdfpages} % Include other pdf
\usepackage{physics} % Vector calculus etc.
\usepackage{siunitx} % Fancy display of SI units
\usepackage{subcaption} % Enables subfigures
\usepackage{titling}
\usepackage{xcolor} % Anything with color e.g. \fcolorbox{black}{red}{}
\usepackage{xurl} % Loads package 'url' and breaks urls nicely

%%%% PACKAGES SETUP COMMANDS
\hypersetup{colorlinks=true,
    urlcolor=blue,
    citecolor=gray}
\captionsetup{width=.8\columnwidth,
    %format=hang, % 'Figure n' in front of whole caption
    labelsep=endash,
    justification=centerlast,
    labelfont={bf}}
\titleformat{\paragraph}[hang]{\normalfont\normalsize\bfseries}{\theparagraph}{1em}{}
\titlespacing*{\paragraph}{0pt}{3.25ex plus 1ex minus .2ex}{0.5em}

%%%% (RE)NEWCOMMAND
% Bold and italic vector symbols (preferably use \vb{} instead)
\renewcommand{\vec}[1]{\boldsymbol{#1}}
% Mono-spaced inline code (for multiline code, use package 'listings')
\newcommand{\code}[1]{\texttt{#1}}
% Equals sign, with number above referencing some equation
\newcommand{\numeq}[1]{\stackrel{\scriptscriptstyle(\mkern-1.5mu#1\mkern-1.5mu)}{=}}
% If-and-only-if sign, with number above referencing some equation
\newcommand{\numiff}[1]{\stackrel{\scriptscriptstyle(\mkern-1.5mu#1\mkern-1.5mu)}{\Leftrightarrow}}
% Numbers a single line in a no-numbering multiline equation* or align*
\newcommand{\numberthis}{\addtocounter{equation}{1}\tag{\theequation}}
% MuMax3
\newcommand{\mumax}{$\mathsf{mumax}^3$}

%%%% EXTRA SYMBOLS
\DeclareSymbolFont{extraitalic}      {U}{zavm}{m}{it}
\DeclareMathSymbol{\Qoppa}{\mathord}{extraitalic}{161}
\DeclareMathSymbol{\qoppa}{\mathord}{extraitalic}{162}
\DeclareMathSymbol{\Sampi}{\mathord}{extraitalic}{165}
\DeclareMathSymbol{\sampi}{\mathord}{extraitalic}{166}
\DeclareMathSymbol{\Stigma}{\mathord}{extraitalic}{167}
\DeclareMathSymbol{\stigma}{\mathord}{extraitalic}{168}

%%%% DOCUMENT
\begin{document}

\includepdf[pages={1}]{Frontpage.pdf} % (download from plato.ea.ugent.be)
\shipout\null % Blank page
\includepdf[pages={1}]{Frontpage.pdf} % (download from plato.ea.ugent.be)

% TODO op het einde: spellingcheck
% - ization ipv isation
% - centre ipv center
% - island ipv droplet
% TODO op het einde: bibliografie check
% - Volgorde in tekst zelf: bv. niet [36,34] maar wel [34,36]
% - Kijken of er geen vreemde tekst in de bibliografie staat
\newpage
\pagenumbering{roman}
% TODO: Toelating tot bruikleen
% TODO: Acknowledgements
% TODO: Abstract + keywords (max. 1 page)
% TODO: Extended abstract (2-6 pages)

{\hypersetup{linkcolor=black}
\tableofcontents
}
\newpage
% TODO: Lijst van afkortingen en symbolen
% TODO: op het einde een symbool vervangen door \sampi voor de lol
% TODO: Radian or degree?
% TODO: Dubbele betekenissen wegwerken
\subsection*{List of constants}
\begin{longtable}{llll}
\toprule
\bfseries Symbol & \bfseries Name &
\bfseries Value \\\midrule\endhead
$k_B$ & Boltzmann constant & \SI{1.380649e-23}{\joule\per\kelvin} \\
\midrule
$\gamma$ & Gyromagnetic ratio & \SI{1.7595e11}{\radian\per\tesla\per\second} \\
$\gamma_0$ & $\mu_0 \gamma$ & \SI{2.2111e5}{\metre\per\ampere\per\second} \\
$\mu_0$ & Vacuum permeability & $4\pi\SI{e-7}{\henry\per\metre}$ \\
\bottomrule
\end{longtable}

\subsection*{List of abbreviations}
\begin{longtable}{llll}
\toprule
\bfseries Abbreviation & \bfseries Full name \\\midrule\endhead
AFM & Anti-ferromagnetic \\
BCC & Body-centered cubic \\
CMOS & Complementary metal-oxide-semiconductor \\
EQCA & Electronic quantum cellular automata \\
FCC & Face-centered cubic \\
FM & Ferromagnetic \\
FSAL & First-same-as-last \\
LL & Landau-Lifshitz \\
LLG & Landau-Lifshitz-Gilbert \\
MFM & Magnetic force microscopy \\
MOKE & Magneto-optical Kerr effect \\
MQCA & Magnetic quantum cellular automata \\
MTXM & Magnetic transmission X-ray microscopy \\
NAND & Not-AND \\ % Quite useless probably
NML & Nanomagnetic logic \\
PEEM & Photoelectron emission microscopy \\
QCA & Quantum cellular automata \\
XMCD & X-ray magnetic circular dichroism \\
\bottomrule
\end{longtable}

\subsection*{List of symbols}
\begin{longtable}{llll}
\toprule
\bfseries Symbol & \bfseries Name &
\bfseries Unit \\\midrule\endhead
$A_{ex}$ & Exchange stiffness constant & \si{\joule\per\metre} \\
$\vb{B}$ & Magnetic flux density & \si{\tesla} \\
$\vb{B_{ext}}$ & External field flux density & \si{\tesla} \\
$\vb{B_{ext,v}}$ & Virtual external field flux density & \si{\tesla} \\
$d$ & Distance between centers of two islands & \si{\metre} \\
$\vb{e_i}$ & Unit vectors along the axes of cubic anisotropy &  \\
$E$ & Energy & \si{\joule} \\
$E_{anis}$ & Anisotropy energy & \si{\joule} \\
$E_{barrier}$ & Energy barrier between stable states & \si{\joule} \\
$E_{demag}$ & Demagnetization energy & \si{\joule} \\
$E_{exch}$ & Exchange energy & \si{\joule} \\
$E_{me}$ & Magneto-elastic energy & \si{\joule} \\
$E_{Zeeman}$ & Zeeman energy & \si{\joule} \\
$f_0$ & Attempt frequency & \si{\hertz} \\
$\vb{H}$ & Magnetic field strength & \si{\ampere\per\metre} \\
$\vb{H_{demag}}$ & Demagnetizing field & \si{\ampere\per\metre} \\
$\vb{H_{eff}}$ & Effective field & \si{\ampere\per\metre} \\
$\vb{H_{ex}}$ & Exchange field & \si{\ampere\per\metre} \\
$\vb{H_{ext}}$ & External field & \si{\ampere\per\metre} \\
$\vb{H_{therm}}$ & Stochastic thermal field & \si{\ampere\per\metre} \\
$I_{XMCD}$ & Intensity of XMCD signal & \si{\watt\per\metre\squared} \\
$J_{ij}$ & Exchange integral for spins $i$ and $j$ & \si{\joule} \\
$K_{c1}$ & First order cubic anisotropy constant & \si{\joule\per\metre\cubed} \\
$K_{c2}$ & Second order cubic anisotropy constant & \si{\joule\per\metre\cubed} \\
$K_{u1}$ & First order uniaxial anisotropy constant & \si{\joule\per\metre\cubed} \\
$K_{u2}$ & Second order uniaxial anisotropy constant & \si{\joule\per\metre\cubed} \\
$L$ & Ellipse major axis & \si{\metre} \\
$\vb{m}$ & Reduced magnetization $\vb{M}/M_{sat}$ &  \\
$\vb{m_i}$ & Magnetic moment of atom $i$ & \si{\ampere\metre\squared} \\
$\vb{M}$ & Magnetization & \si{\ampere\per\metre} \\
$M_{sat}$ & Saturation magnetization & \si{\ampere\per\metre} \\
$\vb{n_i}$ & Unit vector in the direction of $\vb{S_i}$ &  \\
$N$ & Number of switches during a time interval $\tau$ &  \\
$P_i$ & Uniformly random number between 0 and 1 &  \\
$\vb{r}$ & Position vector & \si{\metre} \\
$\vb{s}$ & Lattice displacement field & \si{\metre} \\
$\vb{S_i}$ & Spin of atom $i$ &  \\
$t$ & Time & \si{\second} \\
$t_i$ & Time between thermal switch $i$ and $i+1$ & \si{\second} \\
$T$ & Temperature & \si{\kelvin} \\
$T_C$ & Curie temperature & \si{\kelvin} \\
$T_N$ & N\'{e}el temperature & \si{\kelvin} \\
$\vb{u}$ & Unit vector along the axis of uniaxial anisotropy &  \\
$V$ & Volume of single-domain particle & \si{\metre\cubed} \\
\midrule
$\alpha$ & Gilbert damping constant &  \\
$\alpha'$ & $\frac{\alpha \gamma_0}{1+\alpha^2}$ &  \\
$\alpha_i$ & Orientation of geometry of island $i$ & \si{\radian} \\
$\gamma_0'$ & $\frac{\gamma_0}{1+\alpha^2}$ & \si{\radian\metre\per\coulomb} \\
$\Delta t$ & Time step of numerical update scheme & \si{\second} \\
$\vec{\eta}$ & Random vector from standard normal distribution &  \\
$\theta$ & Inclination in spherical coordinates & \si{\radian} \\
$\Theta_i$ & Instantaneous magnetization angle in the horizontal plane of island $i$ & \si{\radian} \\
$\widetilde{\Theta}_i$ & Relaxed magnetization angle in the horizontal plane of island $i$ & \si{\radian} \\
$\lambda$ & Exchange length & \si{\metre} \\
$\rho$ & Ellipse roundness: ratio between major and minor axes &  \\
$\sigma$ & Photon spin & \si{} \\
$\tau$ & Total simulation time & \si{\second} \\
$\phi$ & Azimuth in spherical coordinates & \si{\radian} \\
$\Phi_i$ & Rotation of island $i$ geometry & \si{\radian} \\
$\chi$ & Angle of real external field in the horizontal plane & \si{\radian} \\
$\widetilde{\chi}_i$ & Angle of virtual external field in the horizontal plane for island $i$ & \si{\radian} \\
$\psi$ & Vector potential & \\
\bottomrule
\end{longtable}



\clearpage
\pagenumbering{arabic}
\section{Introduction}
%\noindent \textit{Note: This section exists to explain nanomagnetic logic to the unfamiliar reader. \textbf{Biaxial island} begins the investigation of the dynamics of a single biaxial island, and is a suitable starting point for those already familiar with nanomagnetic logic.} \bigskip

\noindent An atom may display what is called a \textbf{magnetic dipole moment}, on one hand due to the angular momentum of electrons around the nucleus, and on the other hand due to the intrinsic spin of the elementary particles which make up the atom. The magnetic moment can be defined using the torque the atom experiences in a magnetic field.~\cite{IntroMagneticMaterials} In a material, many atoms are together, and the macroscopic sum of all their magnetic moments is called the magnetization of the material. In a crystalline material, the periodicity of the lattice can give rise to specific orderings of the magnetic moments, like for example ferromagnetism where all individual magnetic moments of neighboring atoms try to align themselves in the same direction. \par 
Such a ferromagnetic material, like iron, nickel or cobalt, consists of many \textbf{magnetic domains}. Each domain, on the order of several tens of micrometers, has a nearly uniform magnetization pointing in a random direction. Because the direction of each domain is random, a ferromagnetic material does not display a macroscopic net magnetization. However, when one fabricates a very small island of several hundred nanometers made of such a ferromagnetic material, it will not be made up of several domains, but rather only one, and will thus have a nearly uniform magnetization. \par
If this island has one or another form of anisotropy, be it due to the crystal structure or the shape of the island, the magnetization will have minimal energy if it lies along a certain axis, called the `easy axis'. \textbf{Shape anisotropy} originates from the observation that the magnetization of a domain preferably orients itself along the long axis of a microscopic structure. An example that is often used is a 2D ellipse, for which the easy axis is equal to the long axis of the ellipse. In general, if a structure has one easy axis (and thus two stable directions), we speak of uniaxial anisotropy. In the case of two easy axes (and thus four stable directions), as will be the main topic of this thesis, this is called biaxial anisotropy. Biaxial shape anisotropy can be achieved with a geometry that is invariant under rotation over \SI{90}{\degree}. \par
In the uniaxial case, there are two stable directions, which can be related to a `0' or `1' bit. Hence, these nanomagnetic islands can be used to create a \textbf{digital logic circuit}. Nanomagnetic logic (NML) computing architectures propagate binary information by relying on dipolar field coupling to reorient closely spaced nanoscale magnets.~\cite{SubnanosecondPropagation_AnisotropyChains} This architecture is promising for its extremely low energy dissipation per operation.~\cite{SubnanosecondPropagation_AnisotropyChains,FourStateLogic,MQCA_RoomTemp}
There have been examples in literature where majority logic gates and NAND gates have been created using nanomagnets.~\cite{GYP-18} Biaxial nanomagnets can be used to encode two bits in one island, because those have 4 stable magnetization directions. This should allow for smaller logic gates due to the increased integration density as compared to uniaxial islands. The main goal of this thesis is to realize a half adder using biaxial nanomagnets. A half adder takes two bits as input and yields two bits as output, so it almost feels natural to design it using biaxial nanomagnets instead of uniaxial ones.
In the following sections, the nature of magnetism and magnetic domains, the concept of quantum cellular automata, signal propagation and techniques for imaging the magnetization will be explained in more detail.

\subsection{Domains}
In 1907, Weiss proposed the idea that a ferromagnetic material contains several uniformly magnetized domains, but that the magnetization of each domain individually is random, thus resulting in a macroscopic zero net magnetization of a large amount of material.~\cite{MuMax3_advances} These domains should not be confused with grains, which are only related to the crystallography. The uniform alignment inside a single domain is due to the quantum mechanical Heisenberg-Dirac exchange interaction.~\cite{MuMax3_advances, heisenberg1928theorie} The magnetostatic energy makes it unfavorable for neighboring moments to align themselves parallel to one another, which competes with the exchange energy which tends to align neighboring moments in the same direction. Since the exchange energy only acts on small length scales, domains are formed under the influence of the exchange energy, while different domains tend to cancel out each other's fields due to the magnetostatic energy. \par
The typical size of these domains is on the order of several tens of micrometers. When the size of the material becomes on the order of micrometers, the domains form very symmetric patterns in order to minimize their energy, and on even smaller length scales only one single domain remains.~\cite{NML_Carlton} So, if one makes a droplet of ferromagnetic material smaller than this typical size, the droplet will have a nearly uniform magnetization, with a magnitude equal to the saturation magnetization of the material.~\cite{NML_Carlton} Such a small droplet can for example be produced using electron beam lithography.~\cite{MQCA_RoomTemp, NML_Carlton} \par
By introducing anisotropy in the droplet, one or more axes can be made energetically favorable for the magnetization. This anisotropy can have two origins: magnetocrystalline anisotropy favors the crystallographic axes, while shape anisotropy can be realized by giving the droplet an elongated shape, for example an ellipse instead of a perfect circle. In the uniaxial case, there is one stable magnetization axis, so the two directions `up' and `down' along this axis can be related to bits `0' and `1'.~\cite{MQCA_RoomTemp} This is not to be confused with unidirectional anisotropy, which only has one stable magnetization direction, and can be achieved using the exchange bias effect.~\cite{ExchangeBias_Mechanisms,ExchangeBias_nanostructures,ExchangeBias} A lot of research has been conducted to use uniaxial anisotropy for computation, and logic gates and wires have been proposed, which use classical magnetostatic interactions to propagate the information.~\cite{GYP-18,MQCA_MajorityGate,SwitchingForced_EnergyEfficient} The use of two favorable axes, i.e. biaxial anisotropy, allows for a higher logic density, as the four stable directions `up', `down', `right' and `left' can be related to `00', `01', `10' and `11'.~\cite{MQCA_ImageRecognition} This can occur for cubic crystals, and can also be realized by giving the shape of the droplet more symmetry, for example by making the shape the union of two ellipses.


\subsection{Quantum Cellular Automata}
Traditional digital logic technologies like CMOS use field-effect transistors to control the flow of electrons. This kind of architecture fundamentally only allows information to flow in one direction. Other architectures allowing communication between the output and input in both ways could allow certain types of computations to be executed faster. One approach to realizing such an architecture are the Quantum Cellular Automata (QCA), which use quantum effects, in a broad sense, to make logic gates. A cellular automaton is a mathematical concept, proposed by Von Neumann~\cite{Sideinfo_SelfRepAutomata}, in which the universe is divided into a regular grid of cells, where each cell is influenced by its direct neighbors. The most famous example of such a mathematical cellular automaton is Conway's Game of life, which has been shown to be universal for computation, as any Turing machine can be encoded in it.~\cite{QCA_GameOfLife} Apart from the universality in the Turing sense, cellular automata provide an additional benefit because they are able to process algorithms in a distributed manner due to the spatial parallelism inherent to them.~\cite{QCA_GameOfLife} From a practical point of view, QCA can be orders of magnitude smaller and more energy efficient than traditional CMOS technology.~\cite{MQCA_RoomTemp} \par
There are several possibilities to realize QCA, which can generally be classified as either electronic or magnetic QCA. Electronic QCA (EQCA) make use of the forces between electrons, while magnetic QCA (MQCA) leverage the magnetic moments of atoms. EQCA are called ``quantum'' because they use quantum mechanical tunneling of charge between quantum dots, MQCA are quantum because of the exchange interaction between individual atomic magnetic moments.~\cite{MQCA_RoomTemp} Apart from this quantum nature of the building blocks, QCA are essentially classical devices switching through either coulombic or magnetic interactions.~\cite{QCA_Algorithms} What all these QCA have in common, is that every fundamental building block (electrons, magnetic moments...) of these automata influences every other building block in the automaton, thus allowing the aforementioned two-way flow of information between what would traditionally be referred to as input and output. The MQCA are the main subject of this paper, but it is interesting to take a short look at EQCA as well, for both share some ideas and problems. \par
% Small segue to quantum dot cellular automata
One specific implementation of EQCA makes use of square cells, each with four quantum dots at the vertices of a square. These quantum dots can accomodate an electron, and each cell is made such that there are always two excess electrons present. It is then energetically favorable for these electrons to occupy two diagonally opposite quantum dots.~\cite{QCA_DigitalLogicGate} The two possible diagonal configurations are then the `0' and `1' states. An extensively studied logic gate using this architecture is the three-input majority logic gate. It consists of five cells arranged in a plus-shape, with three inputs and one output. Just like the familiar NAND gate, the majority gate is universal for computation.~\cite{NML_Carlton} By fixing one of the inputs to 0 or 1, an AND or an OR operation can be realized, respectively. A drawback of these EQCA is that they require low electron temperatures in order to work reliably, as otherwise thermal smearing of the charge states of the dots becomes an issue.~\cite{QCA_DigitalLogicGate} \par
QCA compute by relaxing to a configuration of minimal energy.~\cite{QCA_Algorithms} It is important that all these relaxed configurations are equal in energy level. This is what is meant by `balanced' QCA. A necessary condition for an automaton to be balanced is that the number of distinguished configurations with minimum energy should be equal to the number of input combinations the automaton handles.~\cite{QCA_Algorithms}



\subsection{Nanomagnetic islands}
\label{par:Intro_nanomagnetic-islands}
As was mentioned before, the magnetization of a nanomagnetic island likes to align itself along the longest axis of a given geometry. This can be understood as follows. Consider a theoretically ideal island so small that it only consists of two atoms, and thus only two magnetic moments. Three different situations are then shown in~\cref{fig:Intro_IslandEllipticPreferredDirection}.
The first configuration has both moments vertical and in the same direction, which makes their magnetic fields nicely lined up, hence this is a low energy state. The second configuration has the magnetic moments in opposite directions, such that their fields oppose each other, which is not a low energy configuration. The third configuration has both moments horizontal and oppositely directed, which once again has the magnetic fields nicely lined up in a low energy state. In the fourth configuration they are pointed horizontal and in the same direction, so the fields once again oppose each other and we do not have a low energy state. Thus, only two of these four configurations are energetically favorable. Now note that we are only dealing with ferromagnetic materials, which have the property that neighboring moments like to align themselves in the same direction, due to the exchange energy (\cref{par:Energy_Exchange}). This only leaves the first situation as a stable one, hence explaining the \textbf{tendency for ferromagnetic materials to be magnetized along the long axis of a microscopic geometric structure}. In larger geometric structures however, the third configuration is a perfectly acceptable way for two separate domains to align themselves, but in this thesis we are only dealing with small single-domain islands. \par
\begin{figure}[t]
    \centering
    \includegraphics[width=0.8\columnwidth]{Figures/Introduction/NML_Carlton - Figure 1.9 adapted.png}
    \caption{Theoretical situation where an island is made up of two magnetic moments, for four different configurations, explaining the tendency for ferromagnetic materials to be magnetized along the long axis of a microscopic geometric structure. Figure adapted from fig. 1.9 in \cite{NML_Carlton}.}
    \label{fig:Intro_IslandEllipticPreferredDirection}
\end{figure}
In case of higher symmetry, for example with biaxial shape anisotropy, it is no longer clear which symmetry axes will be the easy axes, and which the hard ones, as will be examined in more detail in \cref{par:Biaxial_island}.  \par
% TODO: Make this discussion of exchange bias clearer, because it is all over the place now
When constructing a logic gate, it can be useful to include islands whose magnetization direction is permanently fixed, as opposed to the free-switching islands discussed before. One way to realize such a fixed island is through a phenomenon called `exchange bias'.~\cite{ExchangeBias_Mechanisms,ExchangeBias_nanostructures,ExchangeBias,syllabus_PoAEaPD} This phenomenon arises at the interface between an anti-ferromagnetic (AFM) and a ferromagnetic (FM) material due to their exchange anisotropy as illustrated in \cref{fig:Intro_ExchangeBias}.
% TODO: move the mention of 'exchange anisotropy' somewhere else
\begin{figure}[t]
    \centering
    \includegraphics[width=0.8\columnwidth]{Figures/Introduction/Syallabus_PoAEaPD - Figure 2.7.png}
    \caption{The exchange bias effect in ferromagnet/antiferromagnet bilayers with exchange field on the ferromagnetic layer, $\vb{H_{ex}}$, originating from the interface. Figure taken from \cite{syllabus_PoAEaPD}.}
    \label{fig:Intro_ExchangeBias}
\end{figure}
An AFM material consists of magnetic moments which alternate direction in each atomic plane, while in a FM material all these moments point in the same direction. In the situation as illustrated in the figure, the top layer of the AFM material thus also wants the bottom layer of the FM to align anti-parallel, while the FM layer on the contrary prefers a parallel alignment. One of these two competing effects will be stronger than the other, which often results in an anti-parallel alignment of the magnetic moments at the FM/AFM interface. The AFM material is not affected by external fields since it consists of alternating magnetic moments which leads to a zero net magnetization. The AFM layer will thus remain fixed at temperatures below its N\'{e}el temperature $T_N$, which in turn fixes the FM layer. At strong enough fields, however, the FM layer will follow the external field anyway, though this will occur at significantly higher fields than for the case where there would be no AFM material. Thus, by manufacturing a FM island on top of an AFM material, the island can be made to have a single preferential direction. \par
One might wonder how to define the specific magnetization direction of such an anti-ferromagnetically coupled island in the first place. By choosing materials where the N\'{e}el temperature $T_N$ of the AFM layer is lower than the Curie temperature $T_C$ of the FM layer, one can operate at a temperature $T$ for which $T_N < T < T_C$. In this regime, the FM layer will follow an applied magnetic field, while the AFM layer is paramagnetic due to the high temperature and hence does not influence the hysteresis of the FM layer. When the temperature is then lowered below $T_N$, the AFM material will settle in such a way that its top layer is correctly aligned as to fix the FM layer.~\cite{ExchangeBias_Mechanisms} \par
In general, it will be required to fix different islands in different directions. This can not be achieved by heating the whole substrate and applying an external field, so one has to use a local heating process, for example a focused laser beam. By separately heating each island above $T_N$ and allowing it to cool below $T_N$ before heating the next island, one can still make use of an external field, synchronized with the laser, to control the orientation of each fixed island separately. \par
The switching between stable states of a free FM island in absence of exchange bias can be interpreted as a simple hysteresis of the magnetization $\vb{M}$ as function of the external magnetic field $\vb{H}$. The exchange bias effect shifts this hysteresis loop along the $\vb{H}$-axis, as shown in \cref{fig:Intro_ExchangeBias}. % TODO: talk about how hysteresis of a non-exchange-bias-coupled island before this somewhere

\subsection{Signal Propagation}
Nanomagnetic logic gates need to be able to communicate with each other in order to form a larger and more useful circuit. For this, nanomagnets are placed next to each other, such that they form a sort of chain. Signal propagation through chains of nanomagnets does however come with some large complications. One of the advantages of nanomagnetic logic is that different islands influence each other, but this bidirectional interaction causes problems when trying to propagate signals. Let us start with examining the uniaxial case, as this has been studied most intensively, and then extend our knowledge to biaxial signal propagation.
\subsubsection{Uniaxial}
For islands with uniaxial anisotropy, a chain can be formed by placing elliptic islands next to each other, either along their hard axes (\cref{fig:Intro_IslandEllipticChainGeometries}, left) or along their easy axes (\cref{fig:Intro_IslandEllipticChainGeometries}, right). In the first case, nearest-neighbour dipolar field coupling imparts a preference for these islands to align antiparallel, while in the second case the preferential orientation is parallel. Let us consider the first case now, as the second case is similar but less optimal, the reason for which will be addressed at the end of this section. % TODO: is the other case extremely similar? I guess so, but I want to see evidence of this because in NML they use additional stabilizers for that configuration, so best to talk about that later. Idea why they are different: when initializing along the hard axes, this is ok for the left figure, but in the right figure they are then antiparallel which could be quite problematic without additional stabilizers
\begin{figure}
    \centering
    \includegraphics[width=0.5\columnwidth]{Figures/Introduction/Chains_geometries.pdf}
    \caption{Two possible chain geometries for uniaxial islands. \textbf{Left:} chain along the islands' hard axis. \textbf{Right:} chain along the islands' easy axis.}
    \label{fig:Intro_IslandEllipticChainGeometries}
\end{figure} \par
Suppose an initial situation as shown at the top of \cref{fig:Intro_SolitonRandomWalk}, where the wire has been initialized in a `1' state. Then all subsequent islands will prefer to be magnetized in alternating directions. Now the input bit is forcibly switched, so its magnetization points down, and we wish to propagate this signal through the wire, as shown on the second row of \cref{fig:Intro_SolitonRandomWalk}. The second magnetic moment then wants to align itself up due to its left neighbor (the input bit), but also wants to align itself down due to its right neighbor. As such, no net force acts on the second bit and it will randomly switch. Such a `defect' in the wire is called a magnetic soliton.~\cite{MQCA_RoomTemp} As soon as this second bit randomly changes to the `up' direction, the third bit is now in a similar situation, as shown at the bottom of \cref{fig:Intro_SolitonRandomWalk}, and the soliton has moved one island to the right. Now both the second and third bit have an equal chance of switching, and thus the signal has an equal chance of propagating forward to the output (third bit switches) or backward to the input (second bit switches). Thus, the signal (or, equivalently, the soliton) will perform a random walk along the wire. If the input bit is forced to remain `0', the signal will thus reach the output after a time proportional to the square of the number of nanomagnets in the chain, which is clearly not ideal.~\cite{Wolfram_RandomWalk} Several techniques have been proposed to force the signal to propagate along the wire in one direction.
\begin{figure}
    \centering
    \includegraphics[width=0.5\columnwidth]{Figures/Introduction/Soliton_random_walk_2steps.pdf}
    \caption{Blue arrows are the input bits. Red arrows have no preferred direction due to competing interactions of their neighbors. A dotted line indicates the location of a magnetic soliton. \textbf{Top:} initial ordering of the wire for a `1' (up) input. \textbf{Middle:} input bit changes to `0' (down), causing no net force to act on the second island. \textbf{Bottom:} second island randomly switches, causing no net force to act on the third island anymore either.}
    \label{fig:Intro_SolitonRandomWalk}
\end{figure}
One technique makes use of additional biaxial anisotropy and an external magnetic field. The anisotropy is used to create a shallow energy minimum along the uniaxial anisotropy's hard axis. The biaxial anisotropy can be realized either by choosing a material with intrinsic magnetocrystalline biaxial anisotropy, or by modifying the shape of the island such that it exhibits biaxial anisotropy. The latter gives great control over the relative strength of the biaxial versus uniaxial anisotropy~\cite{SubnanosecondPropagation_AnisotropyChains}. The external field is used to initialize each island in this new shallow energy minimum, along what was previously known as the hard axis, whenever a new bit needs to be propagated, which can be seen as a form of clocking. Due to the shallow energy minimum, the magnetization will first stay along this hard axis until it is disturbed by any of its neighbors. The first island is initialized in either the `0' or `1' state and functions as the input bit. When the external field is removed, the second island will feel the input bit's dipole field, which will cause it to leave the shallow energy minimum and fall onto the easy axis. The third island then feels the second island falling in place, and so on. Thus, the signal successfully propagates in one direction.~\cite{NML_Carlton}
%When the external field is removed, each subsequent island chooses a direction to fall onto its easy axis. If this happens adiabatically, each island will fall in the correct antiparallel configuration and no solitons appear.~\cite{NML_Carlton}
\par
The use of an external magnetic field to reset the wire is not very `clean', because a global external field will affect all the wires in a given circuit. One possible solution is to manufacture the nanomagnetic islands such that each has a piezoelectric layer underneath, which can induce strain in the island, thus exerting a force on the magnetization (see \cref{par:Energy_MagnetoElastic}). Each nanomagnet can then be controlled electronically. Another possibility is to place the nanomagnetic islands between electrodes which produce a spin-polarized current. Through the spin transfer torque, these electrons can then exert a torque on the magnetization.~\cite{SwitchingForced_EnergyEfficient,syllabus_PoAEaPD} \par
By now it is clear why a chain along the hard axes (\cref{fig:Intro_IslandEllipticChainGeometries}, left) is preferred over a chain along the easy axes (\cref{fig:Intro_IslandEllipticChainGeometries}, right). In the latter case, when initializing the islands along their hard axes using an external field, they are being forced in a parallel configuration, while for such adjacent dipoles the minimal energy configuration is antiparallel. Without additional stabilizers, the signal propagation will thus be much more prone to random thermal errors.

\subsubsection{Biaxial}
\begin{figure}
    \centering
    \includegraphics[width=0.5\columnwidth]{Figures/Introduction/Biaxial_chain.pdf}
    \caption{Minimal energy configuration of a balanced chain of biaxial nanomagnets. Blue arrow indicates the input island.}
    \label{fig:Intro_IslandBiaxialChainGeometry}
\end{figure}
The most straightforward way to transmit biaxial information is to use a nanowire in a similar manner as in the uniaxial case, where the biaxial islands are placed with their easy axes in an `XX' configuration. The lowest energy configuration of such an `XX' wire is shown in \cref{fig:Intro_IslandBiaxialChainGeometry}, where the blue island is once again the input. Because of the biaxial anisotropy, there are four possible directions for the magnetization of this input island. Due to the high degree of symmetry of this wire geometry, all four possible inputs have equal ground state energy, so the wire is perfectly balanced. % TODO: refer to the interaction section for a figure with two 45Â° rotated islands
This does, however, also hit the same problems with random walks. Unlike the uniaxial case, this can now no longer be resolved by initializing the islands in between the stable states such that they fall adiabatically to the energy minimum, because there are now four stable perpendicular states and it is hence impossible to place the island in a direction that does not favor any of these four directions.

It is of utmost importance to understand the influence of the wire on the gates, since both influence each other. % TODO: wire influences logic gate greatly

\FloatBarrier
\subsection{Imaging the magnetization}
If one wishes to not only perform theoretical, but also practical studies on nanomagnetic islands, it can be useful to employ specialized microscopy techniques to image the magnetization direction. A small selection of often encountered techniques are presented in this section, each with certain advantages and disadvantages. Many other techniques besides those discussed below exist, like scanning electron microscopy with polarization analysis (SEMPA)~\cite{Imaging_SEMPA}, Lorentz microscopy~\cite{Imaging_Lorentz}, spin polarized scanning tunneling microscopies (SP-STM), superconducting quantum interference devices (SQUID) \dots Note that it is also possible to determine the average magnetization of a single island by adding electrodes and using effects from spintronics, though this can hardly be called an imaging technique, but rather a form of sensing.

\subsubsection{Magnetic Force Microscopy}
Magnetic Force Microscopy (MFM) is a form of scanning probe microscopy that can measure out-of-plane magnetic fields. For this, a cantilever with a magnetic tip is used which is scanned across the sample at a very low height. If this tip were to simply scan over the surface without keeping a small distance to the sample, both the magnetic forces as well as the atomic forces would be measured. To remedy this, the topography of the sample is first determined using conventional atomic force microscopy.~\cite{NML_Carlton, PEEM} Once the topography is known, the magnetic tip can scan the sample while maintaining a constant distance above it at any point using the now known topography. This decouples the measurement of magnetic forces from the atomic forces and allows one to determine only the magnetic field. Important to note is that the force measured is only the out-of-plane component of the magnetic field, because the cantilever can only move vertically and is thus only sensitive to the vertical component of the magnetic field.~\cite{NML_Carlton} One must also take care that the magnetic tip does not significantly influence the magnetization of the sample itself.~\cite{Probing_MagnetoOptics} \par
When imaging a nanomagnet, it will manifest itself in the output as the combination of a region with positive and a region with negative out-of-plane magnetic field, because the stray magnetic field of a dipole curls back on itself.~\cite{NML_Carlton} An example of an MFM image of a chain of nanomagnets is shown at the top of~\cref{fig:Intro_Imaging}. \par
The main disadvantage of MFM is that it does not image the magnetization directly, but rather the stray out-of-plane magnetic fields, which can make the results more difficult to interpret. It can however achieve a very high resolution due to its close resemblance to atomic force microscopy. Furthermore, it is a relatively cheap and commonly available technique compared to X-ray based techniques, which are discussed in the next section.

\subsubsection{X-ray Magnetic Circular Dichroism: PEEM and MTXM}
Both Photoelectron Emission Microscopy (PEEM) and Magnetic Transmission X-ray Microscopy (MTXM) are techniques which rely on a physical phenomenon called X-ray Magnetic Circular Dichroism (XMCD). This effect states that the number of electrons emitted from the sample upon irradiation with circularly polarized X-rays depends on the magnetization direction of the surface of the sample.~\cite{NML_Carlton} More specifically, the measured quantity is the angle $\theta$ between the magnetization direction $\vb{M(\vb{r})}$ of the sample and the photon spin $\vec{\sigma}$, which is aligned with the photon propagation direction and changes sign when the photon helicity is reversed.~\cite{PEEM} The intensity of emitted electrons is given by
\begin{equation}
    I_{\mathrm{XMCD}} \propto M_{sat} \cos(\theta) \mathrm{.}
    \label{eq:XMCD}
\end{equation} 
This way, the in-plane magnetization can be measured directly, which can make the results easier to interpret than an MFM image. To achieve high contrast, one can use X-rays with a frequency near an absorption edge.~\cite{SubnanosecondPropagation_AnisotropyChains} \par

Photoelectron Emission Microscopy (PEEM) images these secondary electrons emitted from the sample upon irradiation with X-rays. This kind of electron microscopy can achieve a high spatial resolution of less than \SI{50}{\nano\metre}, with a typical probing depth in metals of about \SI{2}{\nano\metre} due to the mean free path of the electrons, so PEEM is a surface sensitive technique. A slightly more detailed description of the geometry and image acquisition process of this kind of electron microscope can be found in~\cite{PEEM}. \par 

Magnetic transmission X-ray microscopy (MTXM) is a similar technique which also relies on XMCD. However, instead of detecting the number of emitted electrons as in PEEM, it is now the transmission of X-rays through the sample that is measured. The penetration depth of \SI{1}{\kilo\electronvolt} X-rays is about \SI{100}{\nano\metre}.~\cite{Imaging_MTXM} MTXM can be used to image the magnetization dynamics themselves on sub-nanosecond time scales; imaging as fast as \SI{100}{\pico\second} has been reported and used in literature and techniques for probing on femtosecond time scales are under research.~\cite{SubnanosecondPropagation_AnisotropyChains, Imaging_MTXM} \par

Besides the magnetization direction, also the chemical composition of the sample can be determined using the spectrum of emitted electrons or transmitted X-rays for PEEM and MTXM, respectively.~\cite{PEEM,Imaging_MTXM} Unfortunately, since XMCD requires circularly polarized X-rays, both imaging techniques require a synchrotron light source and corresponding equipment like helical undulators, which are only available at specialized institutes.

\begin{figure}
     \centering
     \begin{subfigure}[b]{0.8\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/Introduction/NML_Carlton - Figure 1.15 cropped.png}
     \end{subfigure}
     \begin{subfigure}[b]{0.8\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/Introduction/NML_Carlton - Figure 1.17 cropped.png}
     \end{subfigure}
     \caption{Typical MFM (top) and PEEM (bottom) image of the same chain of elliptical nanomagnets, clearly indicating that these two techniques are sensitive to different components of the magnetic field. Dark regions correspond to low measured values, light regions to high values. Figures taken from \cite{NML_Carlton}.}
     \label{fig:Intro_Imaging}
\end{figure} % TODO: perhaps refer to the geometry of the chain as well, this was already mentioned before in the 'signal propagation' part so a quick reference should suffice

\subsubsection{Magneto-Optical Kerr Effect}
The Magneto-Optical Kerr Effect (MOKE) is another physical phenomenon that can be used to determine the magnetization direction. A linearly polarized laser beam is focused onto the sample, and the polarization state of the reflected light is measured in order to access the longitudinal Kerr effect.~\cite{MQCA_RoomTemp} This effect states that, depending on the angle between the magnetization and the incoming light, the reflected light will become elliptically polarized to a certain degree.~\cite{KerrFaraday_book} The effect is small, but the ellipticity is directly proportional to the cosine of the angle, which can then be used to derive the magnetization direction. There also exists the transversal Kerr effect, though this is not often used as it results in a change in reflectivity, which is more difficult to detect and prone to error. \par
Due to the diffraction limit of the laser, MOKE-based techniques have a low resolution and can only measure the average magnetization over a larger area, on the order of several \si{\micro\metre\squared}. For structures smaller than this diffraction limit the signal strength diminishes.~\cite{Probing_MagnetoOptics} One must take care that the focused laser beam does not excessively heat up the sample, as this could influence the magnetization itself. The temperature rise for a \SI{2.5}{\milli\watt} laser focused on a \SI{5}{\micro\metre} diameter spot was however found to be negligible by Cowburn \textit{et al.}~\cite{Probing_MagnetoOptics} \par
This measurement technique can be easier or cheaper to set up than X-ray based techniques, but the (very) low resolution does not allow the imaging of individual nanomagnets in complex structures.

\clearpage
\section{Physics}
In a crystalline material, the atoms are evenly spaced. Each atom has a discrete magnetic moment $\vb{m_i}$ associated with it. The interaction of these many magnetic moments can give rise to macroscopic effects. Since every magnetic moment interacts with every other magnetic moment, the underlying problem is a discrete N-body problem. Unfortunately, such a problem quickly becomes very hard if not impossible to solve analytically for even very few bodies, hence restricting analytical calculations to very small systems.~\cite{abert2013discrete} Due to the lack of an analytical solution, many particular problems can only be solved approximately in a numerical manner.~\cite{abert2013discrete} Even with numerical techniques, the computational power or time required to solve an N-body problem increases rapidly for an increasing amount of bodies, due to the number of interactions. For this reason, a continuum theory was developed, called the micromagnetic theory. In this formalism, the magnetization is represented by the continuous magnetization field, denoted by $\vb{M}(\vb{r}) = M_{sat} \vb{m}(\vb{r})$. This is the magnetic moment per unit volume averaged over a small region of space, with $M_{sat}$ [\si{\ampere\per\metre}] called the saturation magnetization.~\cite{Gilbert1956} $\vb{m}(\vb{r})$ is a unit vector field called the reduced magnetization, which should not be confused with the individual magnetic moments $\vb{m_i}$. $\vb{M}(\vb{r})$ has constant norm because of the even spacing of atoms in the crystal structure.~\cite{abert2013discrete}
The size of this small region is characterized by the exchange length $\lambda$, a formula for which is given by \cref{eq:Energy_ExchangeEnergy_ExchangeLength}. It should be much smaller than the size of a single magnetic domain, yet much larger than a crystal unit cell, so on the order of several nanometres. It is clear that this continuum approximation is only applicable if locally all discrete magnetic moments try to align themselves parallel to each other, i.e.
\begin{equation}
    \vb{m_i} \approx \vb{m_j}~~\mathrm{if}~~\abs{\vb{r_i} - \vb{r_j}} < \lambda \mathrm{,}
\end{equation}
as is for example the case in ferromagnets.~\cite{abert2013discrete} \par
In situations where this approximation holds, the continuum theory can provide a significant computational improvement, because one can now use numerical cells with typical dimensions on the order of $\lambda$, which significantly decreases the amount of variables compared to the original N-body problem, where every single atom had to be taken into account. The characteristic size of a simulation using micromagnetic theory is on the order of tens to hundreds of nanometres, using millions of cells with dimensions on the order of $\lambda$.~\cite{abert2013discrete} Thus, the micromagnetic theory works well on a macroscopic scale and can be solved numerically in a reasonable amount of time, which would be wholly impossible with an N-body approach.


\subsection{Energy contributions}
The energy corresponding to a static configuration of the reduced magnetization field $\vb{m}(\vb{r})$ is the sum of several different contributions
\begin{equation}
    E = E_{exch} + E_{anis} + E_{demag} + E_{Zeeman} + E_{me} \mathrm{.} \label{eq:Energy_Terms}
\end{equation}
The physical nature of these different terms along with small derivations to accomodate them to the continuum approximation are presented in this section.
\subsubsection{Exchange energy}
\label{par:Energy_Exchange}
The exchange energy is of quantum mechanical origin. It tries to align neighboring spins and takes on the simple form
\begin{equation}
    E_{i,j} = -J_{ij} \vb{S_i} \vdot \vb{S_j} \mathrm{.}
    \label{eq:Energy_ExchangeEnergy_Discrete}
\end{equation}
Summing over all contributions gives
\begin{equation}
    E = -\sum_{i,j} J_{ij} S^2 \vb{n_i} \vdot \vb{n_j} \mathrm{,}
    \label{eq:Energy_ExchangeEnergy_SumDiscrete}
\end{equation}
with $\vb{S_i} = S \vb{n_i}$ and $\abs{n_i} = 1$. 
The sign of $J$ determines whether the spins align parallel ($J>0$) or anti-parallel ($J<0$). A parallel alignment results in a so-called ferromagnetic material, while an anti-parallel alignment is characteristic of an anti-ferromagnetic material. \par
Micromagnetic theory makes use of the magnetization field $\vb{m}(\vb{r})$, while \cref{eq:Energy_ExchangeEnergy_Discrete} is discrete. An equation similar to \cref{eq:Energy_ExchangeEnergy_SumDiscrete}, but for the continuous $\vb{m}(\vb{r})$, can now be written down:
\begin{equation}
    E_{exch} = \int_\Omega \sum_i A_i \vb{m}(\vb{r}) \cdot \vb{m}(\vb{r} + \Delta\vb{r}_i) \mathrm{.} \label{eq:Energy_ExchangeEnergy_SumContinuous}
\end{equation}
Since two particles $i$ and $j$ only feel the exchange interaction when they are close to each other, $\vb{m}(\vb{r}) \cdot \vb{m}(\vb{r} + \Delta\vb{r})$ can be expanded in first order~\cite{abert2013discrete} to
\begin{align*}
    \vb{m}(\vb{r}) \cdot \vb{m}(\vb{r} + \Delta\vb{r}) &= 1 - \frac{1}{2}(\vb{m}(\vb{r}) - \vb{m}(\vb{r} + \Delta\vb{r}))^2 \\
    &\approx 1 - \frac{1}{2}\sum_i(\Delta\vb{r} \cdot \gradient{m_i})^2 \label{eq:Energy_ExchangeEnergy_DotApprox} \mathrm{.}
\end{align*}
This can be substituted into \cref{eq:Energy_ExchangeEnergy_SumContinuous}~\cite{abert2013discrete,Gilbert1956}, finally yielding
\begin{equation}
    E_{exch} = A_{ex} \int_\Omega \sum_i (\gradient{m_i}(\vb{r}))^2 \, d\vb{r} \mathrm{.} \label{eq:Energy_Term_Exchange}
\end{equation}
$A_{ex}$ is called the exchange stiffness constant.~\cite{Gilbert1956} The physical interpretation of this energy term is that the magnetization tries to align itself as smoothly as possible.
The exchange length $\lambda$, which characterizes the length scale over which the magnetization can still be approximated as nearly uniform, is defined in SI units \cite{ExchangeLength, ExchangeLength_original, MuMax3} as
\begin{equation}
    \lambda = \sqrt{\frac{2 A_{ex}}{\mu_0 M_{sat}^2}} \mathrm{.}
    \label{eq:Energy_ExchangeEnergy_ExchangeLength}
\end{equation}
It can be used as a rule of thumb for the cell size of micromagnetic simulations, which should be smaller than $\lambda$ such that sampling at that length scale is sufficient to capture all relevant details.~\cite{ExchangeLength}

\subsubsection{Anisotropy energy}
A material may exhibit anisotropy due to its crystal structure. The most often encountered types of anisotropy are uniaxial and cubic anisotropy. Uniaxial anisotropy is common in hexagonal or tetragonal crystal structures, while cubic anisotropy is often present in FCC or BCC structures.~\cite{Gilbert1956, abert2013discrete} \par
In the uniaxial case, the energy is minimal when the magnetization lies along a certain axis $\vb{u}$. In the cubic case, there are three such axes $\vb{e_i}, i=1,\dots,3$, which are all equivalent. The direction of $\vb{M}$ along this axis (i.e. $\vb{m}=\pm \vb{u}$) does not matter, such that $E(\vb{m}_{min}) = E(-\vb{m}_{min})$. For this reason, only even orders in the Taylor expansion are considered.~\cite{abert2013discrete} For uniaxial anisotropy this gives
\begin{equation}
    E_{anis,u} = - \int_\Omega \big(K_{u1} (\vb{m} \cdot \vb{u})^2 + K_{u2} (\vb{m} \cdot \vb{u})^4 + \dots\big) \, d\vb{r} \mathrm{.} \label{eq:Energy_Term_AnisUniaxial}
\end{equation}
The coefficients $K_{ui}$ [\si{\joule\per\metre\squared}] are called the uniaxial anisotropy constants.
For cubic anisotropy, one can use a similar symmetry reasoning~\cite{abert2013discrete} to find
\begin{equation}
    E_{anis,c} = \int_\Omega \big(K_{c1} (m_1^2m_2^2 + m_2^2m_3^2 + m_3^2m_1^2) + K_{c2} m_1^2m_2^2m_3^2\big) \, d\vb{r} \mathrm{,} \label{eq:Energy_Term_AnisCubic}
\end{equation}
with $m_i(\vb{r}) = \vb{m}(\vb{r}) \cdot \vb{e_i}, i=1,\dots,3$.

\subsubsection{Demagnetization energy/Magnetostatic energy}
The demagnetization energy, often also called the magnetostatic energy, is the energy arising from the interaction of every magnetic moment in a ferromagnetic material with the force of every other magnetic moment in the material.~\cite{NML_Carlton} In other words, it is the energy of the magnetization in the magnetic field created by itself.~\cite{abert2013discrete}
From classical electrodynamics it is known that, in the absence of currents,
\begin{align}
	\div{\vb{B}} &= 0 \label{eq:Energy_Demag_DivB0} \\
	\curl{\vb{H}} &= 0 \label{eq:Energy_Demag_CurlH0} \\
	\vb{B} &= \mu_0 (\vb{H} + \vb{M}) \label{eq:Energy_Demag_BHM} \mathrm{.}
\end{align}
From \cref{eq:Energy_Demag_CurlH0} immediately follows that $\exists \psi(\vb{r}): \vb{H} = -\gradient{\psi}$. By substituting \cref{eq:Energy_Demag_BHM} in \cref{eq:Energy_Demag_DivB0} it is then clear that
\begin{equation}
    \laplacian{\psi} = \div{\vb{M}} \mathrm{.}
\end{equation}
The solution of this Laplace equation, for the boundary condition $\abs{\vb{r}} \rightarrow 0 \Rightarrow \psi \rightarrow 0$, is found using Green's function and Green's theorem:
\begin{align*}
    \psi(\vb{r}) &= -\frac{1}{4\pi}\int_\Omega \frac{\boldsymbol{\nabla'\,\vdot}\,\vb{M}(\vb{r'})}{\abs{\vb{r}-\vb{r'}}} \,d\vb{r'} + \frac{1}{4\pi}\int_{\partial\Omega} \frac{\vb{M}(\vb{r'}) \vdot \vb{n}}{\abs{\vb{r}-\vb{r'}}} \,d\vb{s'} \\
    &= \frac{1}{4\pi}\int_\Omega \vb{M}(\vb{r'}) \vdot \boldsymbol{\nabla'} \frac{1}{\abs{\vb{r}-\vb{r'}}} \,d\vb{r'} \mathrm{.}
\end{align*}
A more rigorous derivation is given in~\cite{abert2013discrete}.
From this explicit expression for $\psi(\vb{r})$, one can determine $\vb{H_{demag}} = -\gradient{\psi}$. The energy can then also be found through classical electrodynamics as
\begin{equation}
    E_{demag} = -\frac{\mu_0}{2} \int_\Omega \vb{M} \cdot \vb{H_{demag}} \, d\vb{r} \mathrm{.} \label{eq:Energy_Term_Demag}
\end{equation}
There is an additional $\frac{1}{2}$ factor because each interaction is counted twice.

\subsubsection{Zeeman energy}
If an external field is applied, an additional energy term similar to the demagnetization energy appears, but now without the factor $\frac{1}{2}$ because the interaction comes from an external source:
\begin{equation}
    E_{Zeeman} = -\mu_0 \int_\Omega \vb{M} \vdot \vb{H_{ext}} \, d\vb{r} \mathrm{.} \label{eq:Energy_Term_Zeeman}
\end{equation}

\subsubsection{Magneto-elastic energy}
\label{par:Energy_MagnetoElastic}
In case there is stress present in the crystal lattice, an additional magneto-elastic energy term can be formulated~\cite{Gilbert1956}. For an isotropic material this is given by
\begin{equation}
    E_{me} = B \int_\Omega \sum_{i,j} m_i m_j \frac{\partial s_i}{\partial x_j} \,d\vb{r} \mathrm{,}
\end{equation}
with $\vb{s}(\vb{r})$ the displacement field of the lattice.

\subsubsection{Other energy terms}
Other energy terms still exist to describe other specific phenomena, though these will not be used in this work. An example of such an energy term is the Dzyaloshinskii-Moriya interaction~\cite{DzyaloshinskiiMoriya}, which tries to orient neighboring spins perpendicular to each other, and is responsible for the stabilisation of skyrmions as described in~\cite{skyrmions}. \par Additional torques can also be taken into account, like the Zhang-Li or Slonczewski spin-transfer torques, which describe the interaction between a spin-polarised current and the magnetization~\cite{ZhangLiSpinTransferTorque, MuMax3, syllabus_PoAEaPD}. This effect can be used in information storage technologies like MRAM, magnetic field sensors, among many other applications.~\cite{syllabus_PoAEaPD} % TODO: Put the torques in the 'dynamics' part and leave the energies in the 'statics' part

\subsection{Landau-Lifschitz-Gilbert equation}
The aforementioned energy terms express the potential energy of a static magnetization state $\vb{m}(\vb{r})$, but do not tell us how this magnetization evolves over time. Landau and Lifschitz~\cite{lifdau} first described the time evolution of the magnetization field, as the sum of a precessional and a damping term.~\cite{abert2013discrete, NML_Carlton, phd_leliaert} The Landau-Lifschitz (LL) equation reads
\begin{equation}
    \frac{\partial \vb{m}}{\partial t} = - \gamma_0' \vb{m} \cross \vb{H_{eff}} - \alpha' \vb{m} \cross (\vb{m} \cross \vb{H_{eff}}) \mathrm{.}
    \label{eq:LL}
\end{equation}
The first term describes the precession of the magnetization around the effective field and can be derived from quantum mechanical considerations.  The second term was introduced phenomenologically, to make sure the precession does not carry on forever, and causes $\vb{m}$ to slowly damp toward the effective field vector $\vb{H_{eff}}$.~\cite{NML_Carlton} The effective field $\vb{H_{eff}}$ is defined as
\begin{equation}
	\vb{H_{eff}} = - \frac{1}{\mu_0} \frac{\partial E}{\partial \vb{M}} \mathrm{,}
	\label{eq:H_eff}
\end{equation}
with the energy $E$ the sum of several contributions as explained before. $\partial E/\partial \vb{m}$ means the vector whose components are $\partial E/\partial m_x$, etc.~\cite{ThermFluc_SingleDomain} Some reasons for the phenomenological damping are eddy currents, or spin-lattice coupling.~\cite{phd_leliaert} These are rather macroscopic explanations, which do not tell us anything about the fundamental origin of damping.
\par
In order to obtain a physically more intuitive damping term, Gilbert~\cite{Gilbert1955ALF} proposed an alternative form of the LL equation. He argued that, because $\vb{m}(\vb{r})$ is always a unit vector, its motion can be described by that of a rotating body, thus allowing the use of a Lagrangian formalism to determine the dynamics of the system.~\cite{abert2013discrete} For the kinetic energy term in this Lagrangian, he proposed $-M_{sat}/\gamma \dot{\phi} \cos(\theta)$, with $\phi$ and $\theta$ spherical coordinates and the dot denoting a time derivative, thus relating the damping to the time derivative of the magnetization.~\cite{abert2013discrete} This yields the Landau-Lifschitz-Gilbert (LLG) equation~\cite{ThermFluc_SingleDomain, phd_leliaert, LEL-17b}
\begin{equation}
    \frac{\partial \vb{m}}{\partial t} = - \gamma_0 \vb{m} \cross \vb{H_{eff}} + \alpha \vb{m} \cross \frac{\partial \vb{m}}{\partial t} \mathrm{.}
    \label{eq:LLG}
\end{equation}
Here, $\gamma_0=\mu_0 \gamma$ with $\gamma$ the gyromagnetic ratio. The dimensionless $\alpha > 0$ is called the Gilbert damping constant, and is for example equal to 0.01 for permalloy. The precession frequency in absence of damping, also called the Larmor frequency, is given by  $f_L=\frac{\gamma_0}{2\pi}\abs{\vb{H_{eff}}}$.~\cite{phd_leliaert} 
It is also possible to derive the LLG equation as a limit case of a quantum mechanical description of a spin subject to the effects corresponding to the different energy terms.~\cite{abert2013discrete,bode2012current}
Using the differential form, Hickey \textit{et al.} derived the damping from first-principles~\cite{hickey2009origin}, with the intrinsic origin of the damping being spin-orbit coupling, due to relativistic corrections to the Hamiltonian which couple the spin to the electric field.~\cite{hickey2009origin} This yields an explicit expression for the damping constant $\alpha$ as a function of several fundamental constants and material parameters. \par
Though the LL and LLG equations look slightly different, they can easily be transformed into each other~\cite{ThermFluc_SingleDomain,phd_leliaert} using the substitutions
\begin{align*}
    \gamma_0' &= \frac{\gamma_0}{1+\alpha^2} \\
    \alpha' &= \alpha \frac{\gamma_0}{1+\alpha^2} \mathrm{.}
\end{align*}
Because the LLG equation \eqref{eq:LLG} is implicit, the explicit LL equation \eqref{eq:LL} is rather used in computational packages like \mumax{}. %TODO: Remark that this substitution indicates that, in the LLG equation, the precession frequency is dependent on the damping, which means that the LL and LLG equations only represent the same physics in the limit of low damping.  Since the LL equation treats the damping only phenomenologically, it will not describe the physics correctly for high damping, whereas the LLG equation will.~\cite{phd_leliaert}

\begin{figure}
    \centering
    \includegraphics[width=0.9\columnwidth]{Figures/Introduction/abert2013discrete - Figure 2.2.pdf}
    \caption{Motion of a magnetic moment as described by the LLG equation. The motion can be divided into the \textbf{(a)} precessional and \textbf{(b)} damping components. \textbf{(c)} Resulting motion including both precession and damping. Figure taken from~\cite{abert2013discrete}.}
    \label{fig:LLG_motion_Heff}
\end{figure}

\subsubsection{Thermal fluctuations}
% TODO: remove the line in this paragraph that just says where the references come from
The literature in this section comes from the references \cite{LEL-17b}. 
Interesting sources regarding the random thermal switching could be \cite{ThermFluc_SingleDomain, RandomSwitch_MonteCarlo, Nonmonotonic_reversal}, and perhaps \cite{MagDynamics_JumpNoise}. \par
The LLG equation only takes into account the fundamental physics of the magnetization dynamics at zero temperature. However, in our universe things exist at nonzero temperatures, and thermal fluctuations play an important role in magnetic logic devices. % TODO: when I know what the role is exactly, come back here and tell something small about it here
In order to simulate nanomagnetic structures at nonzero temperatures, Brown~\cite{ThermFluc_SingleDomain} developed a theory to model thermal fluctuations in single-domain particles, by adding a stochastic thermal field $\vb{H_{therm}}$ to the effective field $\vb{H_{eff}}$ in the LLG equation. This thermal field has to fulfill certain statistical properties, namely
\begin{align*}
    \langle \vb{H_{therm}} \rangle &= 0 \mathrm{,} \\
    \langle H_{therm,i}(t) H_{therm,j}(t') \rangle &= q \delta(t-t') \delta_{ij} \mathrm{,}
\end{align*}
where $q=(2 k_B T \alpha)/(M_{sat} \gamma_0 \mu_0 V)$, with $V$ the volume of the single-domain particle.~\cite{phd_leliaert} The angled brackets denote either a time average or correlation. With these random and uncorrelated properties of the time-dependent additional field term, the LLG equation becomes a Langevin equation.~\cite{ThermFluc_SingleDomain} However, a nanomagnetic island is not a perfect single-domain particle with uniform magnetization, and different nanomagnetic islands can influence each other through magnetostatic interactions.
Lyberatos~\cite{Lyberatos_1993} realized that every finite-difference cell in a numerical simulation can be seen as one such a single-domain particle, for which Brown's theory can then be applied.~\cite{phd_leliaert} More specifically, the thermal field was implemented in \mumax{}~\cite{LEL-17b,MuMax3} as
\begin{equation}
    \vb{H_{therm}} = \vec{\eta} \sqrt{\frac{2 \alpha k_B T}{M_{sat} \gamma_0 \mu_0 V \Delta t}} \mathrm{,}
    \label{eq:H_therm}
\end{equation}
where $\vec{\eta}$ is a random vector, determined from a standard normal distribution, whose value is changed after every time step. This equation is such that the thermal fluctuations are independent of the spatial discretization (volume $V$ and time step $\Delta t$) used.
% Adaptive time step in mumax problem? Solvers?
There are many finite-difference solvers available in \mumax{}, for example different orders of Runge-Kutta solvers, some of which benefit from the first-same-as-last (FSAL) property. In such solvers, the last torque evaluation of the current step is the same as the first evaluation of the next step, which allows an increase in efficiency because this step only has to be evaluated once. However, the stochastic thermal field is not constant, and hence these solvers can no longer benefit from the FSAL property.~\cite{LEL-17b} Another complication is that the time step $\Delta t$ appears in the expression for $\vb{H_{therm}}$. Since some solvers in \mumax{} improve their efficiency by using an adaptive time step, one must take additional care that the thermal field is calculated correctly in such case. For a detailed description of the implementation of the stochastic thermal field in \mumax{}, we refer to~\cite{LEL-17b}.
% TODO: Can still include something on jump noise process and Curie temperature (phd_leliaert) and a bit more on solvers (start of appendix in phd_leliaert)
% TODO: Find a good place to talk about the advantages of running mumax on gpu, with parallelism etc. (see 'Micromagnetic simulations using Graphics Processing Units')

\clearpage
\section{Biaxial island}
\label{par:Biaxial_island}
The first part of this thesis consists of investigating the properties of a single biaxial island, as this will be the fundamental building block of more complex circuits. The geometry of such an island is one of the main factors determining the energy barrier between stable states. The geometry used throughout this thesis is the union of two perpendicular identical ellipses, as shown in \cref{fig:biaxial_island:geometryTypical}, where \SI{0}{\degree} is defined as the direction pointing to the right, as usual in mathematics. This geometry was chosen because it should be reasonably easy to manufacture due to the lack of sharp corners. This geometry has two `degrees of freedom', namely the long and short axis of the ellipse. We will define the roundness $\rho$ as the ratio of the short over the long axis of the ellipses, and the `overall size' $L$ as simply being equal to the long axis. For example, $(\rho, L)=(0.55, \SI{100}{\nano\metre})$ indicates that the long axis of each ellipse is \SI{100}{\nano\metre} while the short axis is \SI{55}{\nano\metre}. Furthermore, the in-plane angles of several quantities will be used: $\Theta$ denotes the instantaneous average magnetization angle, and its tilde counterpart $\widetilde{\Theta}$ the angle of the magnetization when it is relaxed to a local energy minimum. The angle of an external field is denoted by $\chi$, while its tilde counterpart $\widetilde{\chi}$ indicates a `virtual' external field, which will be explained later. Finally, $\Phi$ denotes the angle by which the geometry of a biaxial island was rotated, i.e. the angle between its ellipse axes and the numerical grid.
\begin{figure}
    \centering
    \includegraphics[width=0.3\columnwidth]{Figures/biaxial_island/Geometry/geomPlus55.png}
    \caption{Typical geometry of the biaxial island under investigation, in this specific case for 55x\SI{100}{\nano\metre} ellipses, i.e. $(\rho, L)=(0.55, \SI{100}{\nano\metre})$. White represents ferromagnetic material, black is free space.}
    \label{fig:biaxial_island:geometryTypical}
\end{figure}

\subsection{Energy barrier}
\label{par:Biaxial_EnergyBarrier}
Due to symmetry reasons, all of $\Theta = k\frac{\pi}{4} , k\in\mathbb{Z}$ are equilibria. However, not all are stable; some are energy minima while some are energy maxima. To determine the energy barrier $E_{barrier}$ for random switching between stable states, the energy landscape as a function of magnetization angle must be calculated. If one were to simply set the magnetization $\vb{M}$ of the entire island in one specific direction and calculate the energy, one finds that the energy is the same for all such directions. This is due to the absence of the demagnetizing field caused by the shape anisotropy of the magnetic body.~\cite{Nonmonotonic_reversal} Thus, the magnetization should first be relaxed to accommodate for the shape of the island, which can be done using the \mumax{} command \code{minimize()}. However, this would result in a complete relaxation to an energy minimum, hence not yielding any useful information on the energy barrier which is the difference between an energy minimum and maximum. To circumvent this issue, an external magnetic field is applied to keep the average magnetization $\frac{1}{A}\int_A \vb{M}\,dA$ close to the initial direction. Practically, this `virtual' external field $\vb{B_{ext,v}}$ is realized through the custom field functionality in \mumax{}, using \code{AddFieldTerm} and \code{AddEdensTerm}. \par
The procedure is therefore as follows. First the magnetization of the entire island $\vb{M}$ is initialized uniformly under an angle $\Theta$ and an external magnetic field is applied along that same direction. Then, the magnetization is relaxed using \code{minimize()}. The internal energy, responsible for the energy landscape, is then equal to $E_{total} - E_{Zeeman}$. This procedure is repeated for different angles $\Theta$ to generate an energy profile from which the energy barrier can be deduced.

\subsubsection{Optimal virtual external field magnitude}
The procedure as described above makes use of an external magnetic field. This is merely out of necessity to make sure that a magnetization initialized in an unstable maximum energy state stays there and does not relax to the energy minimum, which would prevent the determination of the height of the energy barrier. In reality, there is no such field, so this `virtual' external field should ideally be of small magnitude. To investigate the influence of this magnitude on the energy landscape, a simulation is carried out in which both the angle and the magnitude of the external magnetic field are varied. In \cref{fig:barrierLandscape-sweepBext_r0.65} the relaxed magnetization angle $\widetilde{\Theta}$ and corresponding energy are plotted for different magnitudes of the external magnetic field $\abs{\vb{B_{ext,v}}}$, with the angle $\widetilde{\chi}$ of this field taken at 64 equally spaced values from \SIrange{0}{90}{\degree}. Note that the average relaxed magnetization angle is not necessarily equal to the external magnetic field angle, as the relaxation process will tend to more or less cant the magnetization towards the closest intrinsic energy minimum.
\begin{figure}
    \centering
    \includegraphics[width=0.9\textwidth]{Figures/biaxial_island/BarrierLandscape/Plus_65_B25-0.001-div4_a128Pi_plotOptimized.pdf}
    \caption{Energy landscape for a $(\rho, L)=(0.65, \SI{100}{\nano\metre})$ geometry, calculated using various external magnetic field magnitudes $\abs{\vb{B_{ext,v}}}$ as shown in the legend. The external field angle $\widetilde{\chi}$ was varied uniformly in 64 steps from \SIrange{0}{90}{\degree}, for each magnitude, and each dot corresponds to one such angle. The horizontal axis denotes the average angle $\widetilde{\Theta}$ of the magnetization over the whole island after relaxation. Note that this is not necessarily equal to the external field angle, especially for low field magnitudes.}
    \label{fig:barrierLandscape-sweepBext_r0.65}
\end{figure}
\begin{figure}
    \centering
    \includegraphics[width=0.9\textwidth]{Figures/biaxial_island/BarrierLandscape/Plus_48.2_B25-0.001-div4_a128Pi_plotOptimized.pdf}
    \caption{Energy landscape for a $(\rho, L)=(0.482, \SI{100}{\nano\metre})$ geometry, calculated using various external magnetic field magnitudes $\abs{\vb{B_{ext,v}}}$ as shown in the legend. The external field angle $\widetilde{\chi}$ was varied uniformly in 64 steps from \SIrange{0}{90}{\degree}, for each magnitude, and each dot corresponds to one such angle. The horizontal axis denotes the average angle $\widetilde{\Theta}$ of the magnetization over the whole island after relaxation. Note that this is not necessarily equal to the external field angle, especially for low field magnitudes.}
    \label{fig:barrierLandscape-sweepBext_r0.49}
\end{figure}
At very high magnetic fields, the magnetization of the entire island will be nearly uniform and will not follow the shape of the island along the edges. As mentioned before, this causes the energy to be the same for all angles, since it is the relaxation of the magnetization in a non-uniform way which causes the anisotropy, due to the absence of the demagnetizing field.~\cite{Nonmonotonic_reversal} This is the case in the figure for the extremely high field $\abs{\vb{B_{ext,v}}}=\SI{25}{\tesla}$. \par
The lower the magnetic field, the more the magnetization relaxes to the minimum, as evident from the spacing of the dots for each external field magnitude. This is to be expected, as lower magnetic fields will have more difficulty keeping the magnetization pointed in the same direction, against the shape anisotropy. This could cause a problem when trying to determine the value of the unstable energy maximum. This is however not the case, as evident from the single data-point at \SI{45}{\degree}, which stays at the equilibrium even after relaxation. \par
When initializing the magnetization and external field at an angle of \SI{45}{\degree}, the average magnetization angle of the island stays at this unstable maximum after relaxation, for all examined field magnitudes. Since the energy barrier is simply the difference between this unstable maximum and the stable minimum, a low external field of \SI{1}{\milli\tesla} is enough if one is solely interested in the barrier height, and not the whole energy landscape. In case one is interested in the whole energy landscape, a field of about \SI{0.1}{\tesla} is needed as seen in the figure. This does, however, come at the cost of a less accurate calculation of the energy barrier itself. \par

\subsubsection{Energy barrier as function of geometry}
The geometry is the most important factor determining the energy barrier. Shown in \cref{fig:barrier-cell_size} is the dependence of the energy barrier on the roundness $\rho$, for different total sizes $L$. The small 8-fold energy barriers from \cref{fig:barrierLandscape-sweepBext_r0.49}.
are included in this calculation. A positive value in this figure indicates that $E(\Theta=\pi/4) > E(\Theta=0)$, while for a negative value this is opposite. \par %TODO: Include the 8 small energy barriers for the cases where E(0) \approx E(45) in the figure
The behavior as a function of the roundness $\rho$ is most clear by only looking at the blue curve of this figure, i.e. for $L=\SI{128}{\nano\metre}$. Interesting is that the sign of the energy barrier is dependent on $\rho$. The energy barrier is calculated as $E_{barrier} = E(\Theta=\pi/4) - E(\Theta=0)$, so a positive value corresponds to the long axes of the ellipses being the easy axes, while a negative value indicates that an average diagonal magnetization at \SI{45}{\degree} is favored. For $\rho \approx 0.48$, the energy barrier is zero.
% TODO: change this explanation to: In general, the magnetization likes to be horizontal and vertical as these are the longest directions. However, as the 'lobes' become thinner, it is no longer energetically favorable for the whole island to be magnetized nearly uniformly, as this becomes problematic in at least two of the lobes.
This can be understood by looking at the detailed magnetization pattern corresponding to \SI{0}{\degree} and \SI{45}{\degree} in both regimes as shown in \cref{fig:barrier-magnetization}. For the high-roundness shapes as for example in the top row of the figure, the geometry resembles a square. It is known that the stable directions of a square are its diagonals as these are the longest directions of the geometry, and hence also the stable directions of a high-roundness geometry are the long axes of its constituent ellipses. The low-roundness shapes are more clearly consisting of two long ellipses. As explained in the introduction, the magnetization preferably orients itself along the length of such an ellipse. Hence, the sum of the stable states of two orthogonal ellipses is on average a diagonal magnetization. mentioned in the introduction, the magnetization will tend to align itself along the longest axis of a given geometry. Thus, it is logical that the situation in the top left of \cref{fig:barrier-magnetization} is not stable while the one on the right is. In conclusion, the magnetization preferably lies horizontally or vertically at any point in the island regardless of the roundness, though the shape of the island causes the average of these horizontal and vertical parts to either be horizontal and vertical itself, or diagonal.
\begin{figure}
     \centering
     \begin{subfigure}[b]{0.2\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/biaxial_island/BarrierMagnetization/mPlus_roundness0.60_a0.00.png}
         \caption*{Stable}
         \label{fig:barrier-magnetization-60x100_ortho}
     \end{subfigure}
     \begin{subfigure}[b]{0.2\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/biaxial_island/BarrierMagnetization/mPlus_roundness0.60_a0.79.png}
         \caption*{Unstable}
         \label{fig:barrier-magnetization-60x100_diag}
     \end{subfigure}
     \vskip1em
     \begin{subfigure}[b]{0.2\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/biaxial_island/BarrierMagnetization/mPlus_roundness0.20_a0.00.png}
         \caption*{Unstable}
         \label{fig:barrier-magnetization-20x100_ortho}
     \end{subfigure}
     \begin{subfigure}[b]{0.2\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/biaxial_island/BarrierMagnetization/mPlus_roundness0.20_a0.79.png}
         \caption*{Stable}
         \label{fig:barrier-magnetization-20x100_diag}
     \end{subfigure}
        \caption{Relaxed magnetization for two different geometries with $L=\SI{100}{\nano\metre}$. \textbf{Top row:} roundness $\rho=0.6$. \textbf{Bottom row:} $\rho=0.2$. \textbf{Left column:} average magnetization angle $\widetilde{\Theta} = \SI{0}{\degree}$. \textbf{Right column:} $\widetilde{\Theta} = \SI{45}{\degree}$.}
        \label{fig:barrier-magnetization}
\end{figure}
The energy barrier also depends on the total size $L$; when halving $L$, the energy barrier becomes approximately 4 times smaller. This indicates that the energy barrier is proportional to the volume of the island, as its thickness was kept constant.

The energy barrier goes to zero for $\rho \rightarrow 1$, as one would expect for a perfectly round geometry. However, due to numerical error, the barrier is not calculated as exactly zero, which will be discussed in the next section.

\subsubsection{Numerical error: influence of cell size on the energy barrier}
When performing more resource-intensive simulations, it is advantageous to use as large a cell size as possible in order to minimize the total amount of cells in the simulation. Increasing the size of the cells does however also increase the numerical error originating from the discretization of the grid. The size of this numerical error was examined by determining the energy barrier for different shapes (varying roundness and overall size) and for different cell sizes of \SI{4}{\nano\metre}, \SI{2}{\nano\metre} and \SI{1}{\nano\metre}. The results of this calculation are shown in \cref{fig:barrier-cell_size}.
\begin{figure}
    \centering
    \includegraphics[width=0.9\columnwidth]{Figures/biaxial_island/Barrier/Plus_32-128_0.1-1_aPi4_B0.001_cell1nm.pdf}
    \caption{Energy barrier as a function of roundness $\rho$, for different total sizes $L$ as listed in the legend. Cell size \SI{1}{\nano\metre}.}
    \label{fig:barrier-cell_size}
\end{figure}
\begin{figure}
    \centering
    \includegraphics[width=0.9\columnwidth]{Figures/biaxial_island/Barrier/Plus_100_0.1-1_aPi4_B0.001.pdf}
    \caption{Energy barrier as a function of roundness $\rho$, for different cell sizes as listed in the legend. Long ellipse axis $L=\SI{100}{\nano\metre}$.}
    \label{fig:barrier-cell_size-100nm}
\end{figure}
The figure obtained with cells of \SI{1}{\nano\metre} is quite smooth, so it is justified that this size was used in the previous paragraphs. For \SI{2}{\nano\metre} cells, the curve becomes rougher, but the overall shape remains very similar to that of \SI{1}{\nano\metre} cells. Cells of \SI{4}{\nano\metre}, however, yield a very rough and almost stair-like energy landscape, which clearly indicates that this cell size is too large. \par
It is clear that in reality there should be no preferential direction for a round geometry. Because of the cartesian grid, however, a preferential orientation is created in the simulation. For large cells, the energy barrier for a round geometry becomes very large.
The smaller the grid, the more the simulation will resemble reality.
Everything taken into account, it seems that the optimal compromise between simulation speed and accuracy, is a \SI{2}{\nano\metre} cell size. However, if one is solely interested in the behavior corresponding to a specific value of the energy barrier, any cell size can be used as long as the corresponding energy barrier for that discretization is known.

\subsubsection{Energy landscape in presence of an external magnetic field}
% TODO: external field but there is not a lot of interesting things to say about this
The `virtual' external field $\vb{B_{ext,v}}$ used in the previous paragraphs was solely there to make sure the magnetization remains in the energy maximum in order to determine the value of this maximum. Of course, it is also possible to put the biaxial island in a real external field, denoted as $\vb{B_{ext}}$. This will make the energy term in \cref{eq:Energy_Term_Zeeman} nonzero, hence adding a cosine function to the energy landscape. In order to calculate the energy landscape, the virtual external field is still necessary to stabilize the magnetization in the desired direction, away from the global minimum. This can be done in \mumax{} by using a custom field for the virtual external field and using the normal external field functionality for the real external field, hence decoupling the calculation of their energies and allowing the virtual field to be ignored in the energy calculation. The energy landscape for a situation where the external field is applied at $\chi=3\pi/8$ is shown in \cref{fig:barrierLandscape_extField}.
% TODO: mention that there is a second external field
\begin{figure}
    \centering
    \includegraphics[width=0.9\columnwidth]{Figures/biaxial_island/BarrierLandscape/Ext_K0.1Ms2_Bext1e-2-1e-4_a3Pi8.pdf}
    \caption{Energy landscape as function of magnetization angle after relaxation, for different external field magnitudes $\abs{\vb{B_{ext}}}$ as listed in the legend, with the external field applied at an angle $\chi=3\pi/8$.}
    \label{fig:barrierLandscape_extField}
\end{figure}

\subsection{Thermal switching}
Real nanomagnets exist at nonzero temperatures. These thermal fluctuations cause the magnetization of every atom to feel an additional random torque. When these fluctuations randomly add up to a sufficiently large torque, the magnetization can overcome the energy barrier and switch between two stable states. One of the main subjects of interest is the thermal switching frequency that accompanies a certain energy barrier.

\subsubsection{Theory}
Thermal switching is a random process, where the time between two switches is given by the relationship
\begin{equation}
    t_i = -\frac{1}{f_0} \exp(\frac{E_{barrier}}{k_B T}) \ln(1-P_i) \mathrm{,}
    \label{eq:Switching_time}
\end{equation}
valid in the regime where $E_{barrier} \gg k_B T$.~\cite{GYP-18} Here, $P_i$ is a uniformly random number between 0 and 1. The average value of $-\ln(1-P_i)$ is then $\ln(4)$, which reduces \cref{eq:Switching_time} to
\begin{equation}
    t_i = \frac{\ln(4)}{f_0} \exp(\frac{E_{barrier}}{k_B T})  \mathrm{.}
    \label{eq:Switching_time_average}
\end{equation}
Conversely, if one needs to achieve a specific switching time $t_i$, the required energy barrier is given by
\begin{equation}
    E_{barrier} = k_B T \ln(\frac{f_0 t_i}{\ln(4)}) \mathrm{.}
\end{equation}
The main unknown in all previous equations is the attempt frequency $f_0$. As this parameter is crucial to achieve a correct estimate for the switching time, it will be determined both theoretically and through numerical simulations with the biaxial geometry. \par
A theoretical formula for $f_0$ (in \si{\radian\per\second}) in the case of uniaxial anisotropy~\cite{MuMax3, LEL-17b, f0_mumax3_reference} is given by
\begin{equation}
    f_0 = \gamma \frac{\alpha}{1+\alpha^2} \sqrt{\frac{4 K_{u1}^3 V}{\pi M_{sat}^2 k_B T}} \mathrm{,}
    \label{eq:f0_theoretical_uniaxial}
\end{equation}
with $\gamma$ the previously encountered gyromagnetic ratio equal to \SI{1.7595e11}{\radian\per\tesla\per\second}, $\alpha$ the dimensionless damping constant, $V$ the volume of the nanomagnet, and $K_{u1}$ and $M_{sat}$ the uniaxial anisotropy constant and saturation magnetization as defined in the Physics section. The anisotropy constant in general is simply the energy barrier corresponding to said anisotropy, divided by the volume of the particle. Hence, \cref{eq:f0_theoretical_uniaxial} can be adapted to a general anisotropic situation by substituting $K_{u1} \rightarrow E_{barrier}/V$, yielding
\begin{equation}
    f_0 = \gamma \frac{\alpha}{1+\alpha^2} \frac{2}{M_{sat} V} \sqrt{\frac{E_{barrier}^3}{\pi k_B T}} \mathrm{.}
    \label{eq:f0_theoretical_general}
\end{equation}
An alternative formula is found in \cite{f0_alternative_Jonathan}, which after simplification in the absence of an external field simply boils down to twice the value obtained from \cref{eq:f0_theoretical_general}, and thus yields the same order of magnitude. \par
Let us now estimate $f_0$ theoretically using \cref{eq:f0_theoretical_general} at \SI{300}{\kelvin} for a \SI{5}{\nano\metre} thick biaxial island with $L=\SI{100}{\nano\metre}$ made of Permalloy, a material for which $M_{sat}=\SI{8e5}{\ampere\per\metre}$.~\cite{MuMax3} The roundness is chosen such that $E_{barrier}=\SI{155}{\milli\electronvolt}$, as this is one of the barriers that will be used in the simulations later. Since the formulae for $f_0$ merely estimate its order of magnitude, the volume $V$ must not precisely be known and can hence be approximated by the volume of a circular ($\rho=1$) geometry, i.e. $V\approx\SI{4e-23}{\metre\cubed}$. The damping constant is taken as $\alpha=0.01$. \par
This yields a theoretical estimate of $f_0 = \SI{6e6}{\per\second}$. We will compare this to the experimental values obtained through simulations with \mumax{} in the next section.

\subsubsection{Simulations}
Given the total simulation time $\tau$ and the number of switches $N$ during this time interval, an estimate for $f_0$ can be derived from \cref{eq:Switching_time} as
\begin{equation}
    f_0 = \frac{N \ln(4)}{\tau} \exp(\frac{E_{barrier}}{k_B T}) \mathrm{.}
    \label{eq:f0_experimental}
\end{equation}
There exists some ambiguity as to how one can count the amount of switches during a time interval. The method applied here counts every monotone rotation of the magnetization over more than \SI{90}{\degree} in either direction as a switch. Hence, not every crossing of an energy maximum is counted as a separate switch; when the magnetization rotates through multiple energy maxima in quick succession, such switches larger than \SI{90}{\degree} are counted as one single switch. As soon as the magnetization starts turning in the opposite direction, any subsequent \SI{90}{\degree} turn or larger is counted as another switch. \par 
\ctable[
    cap = Switching Rates,
    caption = {Switching rates and corresponding $f_0$ values for different energy barriers (determined by the roundness $\rho$ and grid discretization), temperatures and values of the damping constant. $L=\SI{100}{\nano\metre}$ and $M_{sat}=\SI{8e5}{\ampere\per\metre}$ for all entries.},
    label = {tab:Switching_f0},
    pos = ht,
    %sideways
    ]{
    c|c||c|c|c|c|c||c
    }{
    \tnote[a]{This energy barrier is comparable to the thermal energy $k_B T$. Hence, the switching rate ($\approx \SI{2}{\nano\second}$) is on the same timescale as the LLG dynamics, which causes the estimate for $f_0$ using \cref{eq:f0_theoretical_general} to be inaccurate.}
    }{
        $\rho$ & Grid [nm] & Barrier [meV] & T [K] & $\alpha$ & $\tau$ [ns] & $N$ & $f_0$ \\
        \hline
        0.49 & 2 & 24.7\tmark[a] & 300 & 0.01 & 100 & 37 & \SI{1.33e9}{} \\
        \hline
        0.65 & 4 & 155.0 & 273 & 0.01 & 1000 & 13 & \SI{1.31e10}{} \\
        0.65 & 4 & 155.0 & 300 & 0.1 & 1000 & 12 & \SI{6.68e9}{} \\
        0.65 & 4 & 155.0 & 300 & 0.01 & 1000 & 11 & \SI{6.12e9}{} \\
        0.65 & 4 & 155.0 & 350 & 0.01 & 1000 & 41 & \SI{9.69e9}{} \\
        0.65 & 2 & 286.0 & 350 & 0.01 & 500 & 0 & 0 \\
        0.65 & 3.125 & 207.9 & 350 & 0.01 & 1000 & 9 & \SI{1.23e10}{} \\
        \hline
        1 & 4 & 241.1 & 300 & 0.01 & 1000 & 0 & 0 \\
        1 & 4 & 241.1 & 350 & 0.01 & 1000 & 5 & \SI{2.06e10}{} 
    }
Several simulations were carried out for $\tau$ up to \SI{1}{\micro\second}, where the temperature $T$, the energy barrier and damping constant $\alpha$ were varied. Examples of such simulations are shown in \cref{fig:switching-alpha,fig:switching-temp,fig:switching-49x100-300}, and a summary of all conducted simulations is given in \cref{tab:Switching_f0}. For each simulation, a theoretical value for $f_0$ was estimated using \cref{eq:f0_experimental} as listed in the last column of the table. 
Nearly all simulations for which the energy barrier is significantly higher than the thermal energy yield a value around $f_0=\SI{e10}{\per\second}$, apart from some outliers which did not switch within $\tau$. Unfortunately, this estimate is three orders of magnitude larger than the theoretical estimate determined in the previous section. This indicates that the theoretical \cref{eq:f0_theoretical_general} is not applicable. The reason for this is unclear; perhaps because the magnetization is not perfectly uniform in the simulation, which is one of the assumptions underlying the theoretical formula. \par
The value obtained through the simulations is, however, on the same order of magnitude as the intrinsic resonance frequency of the small sinus of the energy minimum.
Apart from the quantitative measure for $f_0$, some qualitative aspects of changing the parameters will now be addressed.

\paragraph{Effect of damping constant $\alpha$}
\begin{figure}
     \centering
     \begin{subfigure}[b]{0.8\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/biaxial_island/Switching/65x100_300K_alpha0.1_1Âµs_4nm_INSET.pdf}
         \caption{$\alpha=0.1$}
         \label{fig:switching-alpha-0.1}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.8\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/biaxial_island/Switching/65x100_300K_alpha0.01_1Âµs_4nm_INSET.pdf}
         \caption{$\alpha = 0.01$}
         \label{fig:switching-alpha-0.01}
     \end{subfigure}
        \caption{Switching for two different values of the damping constant $\alpha$, with a grid discritization of \SI{4}{\nano\metre} at \SI{300}{\kelvin}, for $(\rho, L) = (0.65, \SI{100}{\nano\metre})$.}
        \label{fig:switching-alpha}
\end{figure}
The effect of changing the damping constant $\alpha$ is shown in \cref{fig:switching-alpha}. There is a clear qualitative difference between $\alpha=0.1$ (\cref{fig:switching-alpha-0.1}) and $\alpha=0.01$ (\cref{fig:switching-alpha-0.01}). For higher $\alpha$, only single switches occur, i.e. \SI{90}{\degree} between adjacent energy minima. For lower damping, switching may occur over more than \SI{90}{\degree}; as an example, there are three switches over \SI{180}{\degree} visible in \cref{fig:switching-alpha-0.01}. This is understandable since the magnetization can be seen as a rotating body as described earlier in the Physics section, so less damping implies that the magnetization will more easily retain its angular velocity after overcoming the first energy maximum and can hence overcome multiple energy barriers in quick succession. \par
From \cref{eq:H_therm}, which gives an expression for the thermal field, it is clear that the magnitude of this thermal field is proportional to the square root of the damping constant. The effect of this is noticeable in the inset figures of \cref{fig:switching-alpha}. For $\alpha=0.01$, the magnetization rotates in a smooth manner, simply oscillating quasi-harmonically in one of the four energy valleys. Because the coupling to the thermal field is weak, the thermal field only introduces randomness in the amplitude of this oscillation, and does not significantly distort the sinusoidal pattern itself. For a higher $\alpha=0.1$, the rotation exhibits more jagged behavior, on the one hand due to the higher damping, on the other hand due to the larger coupling with the thermal field. \par
Quantitatively, the effect of $\alpha$ on $f_0$ can be examined by comparing rows 3 and 4 of \cref{tab:Switching_f0}. There does not seem to be a significant dependence on the damping constant $\alpha$, contrary to the inverse proportionality predicted by the theory of \cref{eq:f0_theoretical_general}, further indicating that the theoretical formula does not apply. Note, however, that the estimate $f_0\approx\SI{e10}{\per\second}$ is quite close to the frequency of the intrinsic oscillation visible in the inset figures (\cref{fig:switching-alpha-0.01}), which has a period of \SI{0.5}{\nano\second}. It would be logical that these two are related, as one can see this oscillation as an `attempt' to leave the energy minimum once every half-period. 
% TODO: The gyromagnetic resonance frequency and response time (see ThermFluc_SingleDomain bottom of first page)

\paragraph{Effect of temperature and energy barrier}
\begin{figure}
     \centering
     \begin{subfigure}[b]{0.49\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/biaxial_island/Switching/65x100_300K_alpha0.01_1Âµs_4nm.pdf}
         \caption{\SI{300}{\kelvin}, \SI{155.0}{\milli\electronvolt}}
         \label{fig:switching-temp-300-65x100}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.49\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/biaxial_island/Switching/65x100_350K_alpha0.01_1Âµs_4nm.pdf}
         \caption{\SI{350}{\kelvin}, \SI{155.0}{\milli\electronvolt}}
         \label{fig:switching-temp-350-65x100}
     \end{subfigure}
     \begin{subfigure}[b]{0.49\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/biaxial_island/Switching/100x100_300K_alpha0.01_1Âµs_4nm.pdf}
         \caption{\SI{300}{\kelvin}, \SI{241.1}{\milli\electronvolt}}
         \label{fig:switching-temp-300-100x100}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.49\textwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/biaxial_island/Switching/100x100_350K_alpha0.01_1Âµs_4nm.pdf}
         \caption{\SI{350}{\kelvin}, \SI{241.1}{\milli\electronvolt}}
         \label{fig:switching-temp-350-100x100}
     \end{subfigure}
    \caption{Switching for different energy barriers and temperatures, with grid discritization of \SI{4}{\nano\metre} and $\alpha = 0.01$. The energy barrier of \SI{155.0}{\milli\electronvolt} corresponds to a geometry with $\rho=0.65$, and \SI{241.1}{\milli\electronvolt} to $\rho=1$.}
    \label{fig:switching-temp}
\end{figure}
It is expected that $f_0$ exhibits an exponential dependency on the ratio between energy barrier and temperature. To confirm this, simulations spanning \SI{1}{\micro\second} were carried out for two different temperatures and two different energy barriers. The different energy barriers correspond to $\rho=0.65$ and $\rho=1$ geometries at a cell size of \SI{4}{\nano\metre}. These have numerical energy barriers of \SI{155.0}{\milli\electronvolt} and \SI{241.1}{\milli\electronvolt}, respectively, with opposite easy and hard axes. This is clearly visible in the figures, as the \SI{155.0}{\milli\electronvolt} case is stable around $n\SI{90}{\degree}$, $n \in \mathbb{Z}$, while \SI{241.1}{\milli\electronvolt} is stable around $\SI{45}{\degree} + n\SI{90}{\degree}$. The exponential dependence on the temperature is qualitatively clear from the difference between \cref{fig:switching-temp-300-65x100,fig:switching-temp-350-65x100}, where the latter switches significantly more for only a \SI{16}{\percent} increase in temperature. The exponential dependence on the energy barrier can be seen in the difference between \cref{fig:switching-temp-300-65x100,fig:switching-temp-350-100x100}, where the latter has not a single switch due to the \SI{55}{\percent} higher energy barrier. The numerical value for $f_0$ is also for these simulations close to \SI{e10}{\per\second}, as listed in \cref{tab:Switching_f0}.

\paragraph{Limit of low barrier}
\begin{figure}
    \centering
    \includegraphics[width=0.8\columnwidth]{Figures/biaxial_island/Switching/49x100_300K_alpha0.01_100ns_2nm.pdf}
    \caption{Switching for $\rho=\SI{49}{\nano\metre}$ island, for which $E_{barrier}=\SI{24.7}{\milli\electronvolt}$ at a grid discretization of \SI{2}{\nano\metre}. Temperature \SI{300}{\kelvin} and $\alpha = 0.01$.}
    \label{fig:switching-49x100-300}
\end{figure} % TODO: remake these plots (here and above) with decent y-axis
In the limit where the energy barrier is comparable to the thermal energy $k_B T$, the exponential law from \cref{eq:f0_experimental} no longer holds. For such a low barrier, the switching rate is on the same timescale as the LLG dynamics, such that besides the energy barrier, now also these dynamics play a role. An example of a \SI{100}{\nano\second} simulation for an energy barrier of \SI{24.7}{\milli\electronvolt} is shown in \cref{fig:switching-49x100-300}. As one would expect, the magnetization does not get stuck in any of the energy minima because they are too shallow. The switching frequency for such a low barrier comes close to that of the intrinsic sinusoidal pattern visible in the inset of \cref{fig:switching-alpha-0.01}.


\clearpage
\section{Interaction between islands}
\subsection{Two islands}
The interaction between two islands can be seen as the contribution of three components: the shape anisotropy of the first island, the shape anisotropy of the second island, and the interaction energy between them. The anisotropy of an island has already been examined in \cref{par:Biaxial_EnergyBarrier}, and depends on its average magnetization angle $\Theta$, total size $L$, and roundness $\rho$. It is expected that the interaction energy between two islands will depend on the distance $d$ between centers of the two islands, the average magnetization angle $\Theta_i$ of each island, their total size $L$, and perhaps to a lesser degree also the roundness $\rho$ and orientation $\Phi_i$ of each island with respect to their common axis. \par
Care needs to be taken that each island is placed on the grid in the correct manner, i.e. such that the numerical energy barrier is known correctly. To keep things simple, the two islands will be kept identical as much as possible, and will hence be placed on identical positions with respect to the cells of the numerical grid. % TODO: What about rotated islands? idk if I must say anything about that, because now I imply that all islands are exactly the same but thats of course not the case for a 45Â° rotated island

\subsubsection{Interaction energy as function of magnetization angle}
\begin{figure}
    \centering
    \begin{subfigure}[c]{4cm} % no problem: this appears blurry online but offline it is nice and sharp
    % TODO: change the E_barrier in the caption to the correct 8-fold value
         \centering
         \includegraphics[width=\textwidth]{Figures/two_islands/Geometry/geom_r0.49_s100_d128_a0,0_cell4nm.png}
     \end{subfigure}
    \begin{subfigure}[c]{0.7\columnwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/two_islands/EnergyLandscape/Int_a0Pi,0Pi_d128_r0.49,0.49_cell4nm.pdf}
     \end{subfigure}
    \caption{\textbf{Left:} geometry for two $(\rho, L)~=~(0.49, \SI{100}{\nano\metre})$ islands spaced \SI{128}{\nano\metre} apart, with \SI{4}{\nano\metre} grid. Corresponding $E_{barrier}=\SI{5.3}{\milli\electronvolt}$. \textbf{Right:} interaction energy as function of the magnetization angle of each island.}
    \label{fig:two-islands_interaction_(0.49,100)_a0,0}
\end{figure}
\begin{figure}
    \centering
    \begin{subfigure}[c]{4cm} % no problem: this appears blurry online but offline it is nice and sharp
         \centering
         \includegraphics[width=\textwidth]{Figures/two_islands/Geometry/geom_r0.66_s100_d128_a0,0_cell1nm.png}
     \end{subfigure}
    \begin{subfigure}[c]{0.7\columnwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/two_islands/EnergyLandscape/Int_a0Pi,0Pi_d128_r0.66,0.66_cell1nm.pdf}
     \end{subfigure}
    \caption{\textbf{Left:} geometry for two $(\rho, L)~=~(0.66, \SI{100}{\nano\metre})$ islands spaced \SI{128}{\nano\metre} apart, with \SI{1}{\nano\metre} grid. Corresponding $E_{barrier}=\SI{353.0}{\milli\electronvolt}$. \textbf{Right:} interaction energy as function of the magnetization angle of each island.}
    \label{fig:two-islands_interaction_(0.66,100)_a0,0}
\end{figure}
\begin{figure}
    \centering
    \begin{subfigure}[c]{4cm} % no problem: this appears blurry online but offline it is nice and sharp
    % TODO: determine the correct energy barrier for a Pi/4 rotated island
         \centering
         \includegraphics[width=\textwidth]{Figures/two_islands/Geometry/geom_r0.66_s100_d128_aPi4,Pi4_cell1nm.png}
     \end{subfigure}
    \begin{subfigure}[c]{0.7\columnwidth}
         \centering
         \includegraphics[width=\textwidth]{Figures/two_islands/EnergyLandscape/Int_aPi4,Pi4_d128_r0.66,0.66_cell1nm.pdf}
     \end{subfigure}
    \caption{\textbf{Left:} geometry for two $(\rho, L)~=~(0.66, \SI{100}{\nano\metre})$ islands spaced \SI{128}{\nano\metre} apart, both rotated over $\Phi=\pi/4$, with \SI{1}{\nano\metre} grid. Corresponding $E_{barrier}=\SI{353.0}{\milli\electronvolt}$. \textbf{Right:} interaction energy as function of the magnetization angle of each island.}
    \label{fig:two-islands_interaction_(0.66,100)_aPi4,Pi4}
\end{figure}
In order to investigate the interaction energy, and the interaction energy only, the islands should be chosen such that their anisotropy is minimal. This can be achieved using \cref{fig:barrier-cell_size-100nm}, by choosing the roundness $\rho$ with the energy barrier closest to zero, which for an island with $L=\SI{100}{\nano\metre}$ happens around $\rho=0.49$. \par
Figure~\ref{fig:two-islands_interaction_(0.49,100)_a0,0} shows the energy landscape for two adjacent $(\rho, L)=(0.49, \SI{100}{\nano\metre})$ islands with their centers spaced \SI{128}{\nano\metre} apart, as a function of their magnetization angles. There are 4 distinct equilibria, if one makes abstraction of global rotations and symmetries: $(\Theta_1, \Theta_2) = (0,0), (0, \pi), (\frac{\pi}{2}, \frac{\pi}{2})$ and $(\frac{\pi}{2}, -\frac{\pi}{2})$. The lowest energy configuration is that where both islands are magnetized in the same direction along their common axis. Conversely, the highest energy occurs for opposite magnetization along this common axis. The two other equilibria are saddle points, corresponding to two distinct situations where both islands are magnetized perpendicularly to their common axis. The one with lowest energy of these two has the two islands oppositely magnetized, while the case with parallel magnetizations has higher energy. This discussion sounds familiar, because the figure simply gives a geometric representation of the behavior discussed at the start of \cref{par:Intro_nanomagnetic-islands} and \cref{fig:Intro_IslandEllipticPreferredDirection}, but now for two separate islands which are not coupled by the exchange energy. The only new information the figure gives us, is that the configuration with opposite magnetization perpendicular to the common axis has higher energy than for parallel magnetization along the common axis. On a similar note, the energy landscape teaches us that switching between energy minima preferably occurs by rotating the magnetization of the two islands in opposite directions. \par
Figure~\ref{fig:two-islands_interaction_(0.66,100)_a0,0} shows the total energy of two interacting islands, but now with nonzero shape anisotropy. To make the contribution of this shape anisotropy to the energy landscape as clear as possible, a geometry with high barrier ($\rho=0.66$) and a small grid (\SI{1}{\nano\metre}) were chosen. As one would expect, this anisotropy simply superposes a sinusoidal pattern with period $\frac{pi}{2}$ in the figures, in both the vertical and horizontal directions, thus creating 16 local minima and maxima. Obviously, if one rotates one of these islands, its anisotropy will rotate as well, manifesting itself in the figure as a translation of this sinusoidal pattern. As compared to the case without anisotropy, one would expect the total height of the energy landscape to increase by double the energy barrier, i.e. \SI{706}{\milli\electronvolt}. However, the total height of the energy landscape has increased more than this, as can be seen from the colorbar on the right hand side of the figures. This can be explained by the fact that, for a $\rho=0.66$ geometry, the volume of the islands is larger than for a $\rho=0.49$ geometry. The increase in energy caused by this additional volume will be significantly higher the closer this additional volume is to the other island, due to the relationship discussed in \cref{par:TwoIslands_EnergyHeight}. This can be confirmed by performing a simulation at $\rho=0.81$ for \SI{4}{\nano\metre} cells, which is another geometry without anisotropy as shown in \cref{par:Biaxial_island}. This simulation yields an energy landscape height of \SI{1.37}{\electronvolt} for $\rho=0.81$, as compared to the \SI{0.74}{\electronvolt} for $\rho=0.49$, clearly showing that the additional volume close to the other island has a significant effect on the energy landscape height. \par
Figure~\ref{fig:two-islands_interaction_(0.66,100)_aPi4,Pi4} shows the energy landscape of two interacting islands rotated over $\Phi=\pi/4$, yielding the geometry on the left of the figure. As was already suggested in the introduction, this geometry can be used as a balanced nanomagnetic logic chain due to its high degree of symmetry. In the energy landscape, there are clearly four identical global minima, along $\Theta_1 = -\Theta_2$. Suppose the leftmost island (island 1) is the input of this chain, then it is energetically favorable for the second island to have its magnetization be the input island's magnetization mirrored over the horizontal axis. This holds for all four stable orientations of the magnetization of the first island, and all these have equal ground state energy, thus confirming the geometry is balanced.

\subsubsection{Energy landscape height as function of distance between islands}
\label{par:TwoIslands_EnergyHeight}
% TODO: add figure here with dots (data) and lines (calculated), and nice axes
% TODO: write short description of this pretty easy to understand relationship
When halving all dimensions, like cell size, inter-island distance, and island size, the energy landscape height also halves. However, for very small distances (i.e. when the islands touch each other) the energy is not exactly half or double anymore. I guess this is because of the exchange energy working on a small distance. Jonathan from the present (which is ironically now also in the past), however, thinks this is quatsch, and it is simply due to the two dipoles not being point dipoles, but of course islands with a finite volume. It is only at a distance of about $1.2 L$ that the energies are reasonably close to being half or double.

\subsection{Half adder}
A half adder is a logic gate which adds two binary input bits. If these two input bits are 1 and 1, the output is 2. The binary representation of 2 is `10', so two output bits are required to represent this number, the first of which is referred to as `carry', the second as `sum'. Thus, a half adder takes two bits as input and gives two bits as output, the truth table of which is given in the left half of \cref{tab:HalfAdder}. For this reason, it could be advantageous to realize a half adder using biaxial nanomagnets, as a single biaxial island has 4 stable states and can thus represent exactly two bits. As such, a half adder realized with biaxial nanomagnets only has one input island and one output island. The truth table of a half adder in the quaternary system inherent to biaxial nanomagnets is shown in the right half of \cref{tab:HalfAdder}. In the quaternary system, the meaning of a half adder as being an `adder' is lost, though of course this meaning is still relevant as it can easily be recovered by returning to the binary counting system.
\ctable[
    cap = Half Adder,
    caption = {Truth table for a half adder, both in binary and quaternary numeral systems.},
    label = {tab:HalfAdder},
    pos = ht,
    mincapwidth = \columnwidth
    ]{
    r|l||r|l
    }{}{
        \multicolumn{2}{c||}{Binary} & \multicolumn{2}{c}{Quaternary} \\
        \hline
        Input & Output & Input & Output \\
        \hline
        00 & 00 & 0 & 0 \\
        01 & 01 & 1 & 1 \\
        10 & 01 & 2 & 1 \\
        11 & 10 & 3 & 2 \\
    }

There are three additional things a nanomagnetic half adder should have:
- Make sure it is not just some numerical coincidence that it is a half adder
- In and output in same 'convention' orientation (not explicitly necessary, but would be very nice and eliminate some potential problems with curving wires)
- Connection to xx input wires without being thrown off balance
- Balancedness, or at the very least that the first excited state for each input possibility is higher in energy than all the ground states for all input possibilities


\subsubsection{First attempt} % TODO: nice title
++ is nice thing to have because it has two outputs in same direction as their inputs, so only things left to do are make two outputs the same, and make this second output's input the final input's output
It is this last rule which is complicated and creates a need for symmetry breaking

The procedure is as follows:
- Define a geometry, in the easiest case with all islands equal $\rho$ and $L$, where each island is defined by its position $(x,y)$, its orientation $\Phi_i$ and whether its magnetization is fixed at that angle or not.
- Use \mumax{}: for each non-fixed island, initialize it in each of 4 possible stable directions, and relax everything. So in total, there are $4^N$ relaxations. Hence, this technique only allows for 7 islands (takes ~1 hour), or if necessary at most 9 (16 hours or something)
- The data this yields is (relaxed magnetization, energy)-pairs, with relaxed magnetization of all islands. It is of course important to take the relaxed magnetization because it might change direction quite a bit when relaxing.
- Use the data in one of these ways:
-- Get the 4 lowest energy configurations for a given input island, so this means the lowest energy configuration for each of 4 possible input states
-- Check if the lowest energy configurations form a half adder for any input/output combination
-- When found an half adder, check if the energies are good. This means for each of 4 possible inputs, look at several of the lowest energy states (e.g. the 5 lowest) and see if the lowest one is significantly lower than the first one and all the others.

- Curved lines: how tight can xx wires turn?

- Inversion symmetry: if there are no fixed islands, then any given magnetization has equal energy as the same magnetization but with all magnetization directions reversed. Hence, a half adder can not exist in absence of fixed islands.


\section{Conclusion}
- Relaxation is necessary for anisotropy to occur
- There exists a transition with zero energy difference between 0 deg and 45 deg, BUT there is still an energy barrier between such stable states. But what I mean is that there is a roundness for which there are 8 stable states instead of 4.
- xx chain is balanced


\newpage
\bibliographystyle{bibliography/unsrtnat2}
\bibliography{bibliography/bibliography.bib}


\end{document}

% TODO AT THE END:
% - Have as few as possible 'degrees' instead of radians
